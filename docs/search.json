[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MF9130E - Introductory course in Statistics",
    "section": "",
    "text": "Welcome!\nYou are on the course website for MF9130E - Introductory Course in Statistics.\n\nThe course is intended for students and researchers who are interested in statistics and R programming, with applications in medical and healthcare data. No previous programming experience is required to participate in this course.\nThis website is developed by the instructors of the course, hosted for free and public access on Github. The course github repository can be accessed here.\nYou can check the course page by UiO for information related to applications, evaluations and other administrative matters.\n\n\nPreparation\nYou should have a working solution of R (either installed on your own laptop, or using Posit cloud) before the course.\nIt would also be helpful if you familiarize yourself with the course website.\n\nGet Started provides some information about software installation, where to download data and code, and some resources.\nCourse material provides an overview and links for the topics we will cover.\nR Lab and Code hosts the lab session notes.\n\n\n\n\nSchedule\nYou can find the official course schedule provided by University of Oslo here. If there is an error in the time and place on this page, please refer to the official schedule.\n\nWeek 1\n\n\n\n\n\n\n\n\n\nDate\nTime\nTopic\nPlace\n\n\n\n\nApr 24\n12:45-16:00\nLecture: course introduction, data and descriptive statistics\nDME, Lille auditorium\n\n\nApr 25\n08:30-11:45\nGuided lab session\nDME, Auditorium 13\n\n\nApr 25\n12:45-16:00\nLecture: probability, Bayes law, diagnostic tests, distributions\nDME, Auditorium 13\n\n\nApr 26\n08:30-11:45\nGuided lab session\nDME, Store auditorium\n\n\nApr 26\n12:45-16:00\nLecture: statistical inference, hypothesis testing, confidence intervals, t-tests\nDME, Store auditorium\n\n\nApr 27\n08:30-11:45\nGuided lab session\nDME, Runde auditorium R105\n\n\nApr 27\n12:45-16:00\nLecture: categorical data analysis\nDME, Runde auditorium R105\n\n\nApr 28\n08:30-11:45\nGuided lab session\nDME, Store Auditorium\n\n\n\n\n\nWeek 2\n\n\n\n\n\n\n\n\n\nDate\nTime\nTopic\nPlace\n\n\n\n\nMay 8\n08:30-11:45\nLecture and lab: exploratory data analysis, transformation, non-parametric methods\nDME, Lille auditorium\n\n\nMay 8\n12:45-16:00\nLecture and lab: sample size, statistical power\nDME, Lille auditorium\n\n\nMay 9\n08:30-11:45\nLecture: study designs, principle of clinical trials\nHelga Engs hus Auditorium 3\n\n\nMay 9\n12:45-16:00\nLecture and lab: regression I\nHelga Engs hus Auditorium 3\n\n\nMay 10\n08:30-11:45\nLecture: regression II\nDME, Auditorium 13\n\n\nMay 10\n12:45-16:00\nLecture and lab: regression II\nDME, Auditorium 13\n\n\nMay 11\n08:30-11:45\nLecture and lab: regression III\nDME, Auditorium 13\n\n\nMay 11\n12:45-16:00\nLecture and lab: survival analysis, course summary\nDME, Auditorium 13"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About the course",
    "section": "",
    "text": "The aim of the course is to make the participants acquainted with basic statistical ideas and methods. No special previous knowledge of mathematics or statistics is assumed. The statistical software R and the RStudio environment will be used in many of the exercises. Analysis of examples from biomedical research will be emphasized.\n\nContact\n\nManuela Zucknick: manuela.zucknick@medisin.uio.no\nValeria Vitelli: valeria.vitelli@medisin.uio.no\nAlvaro Kohn Luque: a.k.luque@medisin.uio.no\nChi Zhang: chi.zhang@medisin.uio.no"
  },
  {
    "objectID": "course_material/course_material_overview.html",
    "href": "course_material/course_material_overview.html",
    "title": "Course material",
    "section": "",
    "text": "On this page you’ll find a list of lecture notes, R lab notes and other material used in this course."
  },
  {
    "objectID": "course_material/course_material_overview.html#week-1",
    "href": "course_material/course_material_overview.html#week-1",
    "title": "Course material",
    "section": "Week 1",
    "text": "Week 1\n\n\n\nTime\nTopic\nNotes\nLab\nOther\n\n\n\n\nApril 24 PM\nCourse introduction\n\nN/A\n\n\n\n\nDescriptive statistics\nExample pdf notes\nN/A\n\n\n\nApril 25 AM\nIntroduction to R\n\n\n\n\n\n\nDescriptive statistics\n\n\n\n\n\nApril 25 PM\nProbability, diagnosistic tests\nProbability Diagnostic tests Distributions\n\n\n\n\n\nStatistical distributions\n\n\n\n\n\nApril 26 AM\nLab session\n\n\n\n\n\nApril 26 PM\nStatistical inference, tests and confidence intervals\n\n\n\n\n\n\nt-tests\n\n\n\n\n\nApril 27 AM\nLab session\n\n\n\n\n\nApril 27 PM\nCategorical data, table analysis\n\n\n\n\n\nApril 28 AM\nLab session"
  },
  {
    "objectID": "course_material/course_material_overview.html#week-2",
    "href": "course_material/course_material_overview.html#week-2",
    "title": "Course material",
    "section": "Week 2",
    "text": "Week 2\n\n\n\nTime\nTopic\nNotes\nLab session\n\n\n\n\nMay 8 AM\nExploratory data analysis, transformation\n\n\n\n\n\nNon-parametric methods\n\n\n\n\nMay 8 PM\nSample size, statistical power\n\nCode\n\n\nMay 9 AM\nStudy design, principles of clinical trials\n\nNA\n\n\nMay 9 PM\nLinear regression I\n\n\n\n\nMay 10 AM\nLinear regression II\n\n\n\n\nMay 10 PM\nSurvival analysis\n\nLab, Code"
  },
  {
    "objectID": "get_started/get_started.html",
    "href": "get_started/get_started.html",
    "title": "Get started",
    "section": "",
    "text": "In this workshop we will be using R. You can either\n\n(recommended) have R and Rstudio installed on your laptop\nor, use Posit cloud (formerly Rstudio Cloud).\n\n\nOption 1: Set up your RStudio on your laptop\nYou will need both R and Rstudio, they are two separate things.\nYou can download Rstudio here. In this page it will ask you to install R, so it should be clear to follow.\n\nYou can download R for Linux, macOS or Windows here or here\n\nOnce you have finished installing both R and Rstudio, open Rstudio, and you should be seeing something like this:\n\n\n\n\n\n\n\nTip\n\n\n\nWatch these YouTube videos if you are stuck.\n\n\n\n\nOption 2: Use Posit Cloud\n\n\n\n\n\n\nNote\n\n\n\nIt is recommended to have R and Rstudio installed on your laptop, this is because you have a better control of where you prefer to download data and course material. This is also useful when you want to analyse your own datasets. For example, you might have to upload datafiles to the server for Posit Cloud to work.\nHowever, if there is a problem with the installation, you can use Posit Cloud as an alternative.\nOn Tuesday morning we will see if most people can successfully make R run on their laptop and make necessary adjustments.\n\n\nPosit Cloud is free of charge for personal users. You need to sign up for a new user account and have internet connection.\n\nOnce you signed up, you can open a new workspace, and it will look like something like this. If it is the first time you use Posit Cloud, it will be empty (i.e. no script or data).\n\n\n\nData\nThe datasets used in this course are stored in this folder.\n\nDownload data\n\nGo to the repository, select the data you want to download by left-click the file name\nIf it is a dataset in .csv, .txt format, you will see something like this\n\n\n\nfind Raw button, right-click, you will see a list of options\nchoose Download Linked File, this will download the data into your default download folder\nalternatively, choose Download linked file as… so that you can change where you put it and file name.\n\n\nIf it is a dataset in .dta, .xlsx or other format, you might not see the data directly:\n\n\n\nfind Download button, left-click, and you will download it into your default download folder.\n\n\nOptional: download data via URL\nIf you feel like it, you can also download data inside R via URL. You can read more about it here.\n\n\n\n\nCode\nR scripts are stored in this folder.\nTo download an R script, it is similar to downloading a dataset\n\nAlternatively, you can create your own R script locally inside Rstudio, by copy and paste the script from Github.\n\n\nResources\nYou will find the material used in class on this page.\nWe keep updating the material, so please stay tuned!\n\nBooks and papers\nYou can find these books in the library.\n\nEssential medical statistics (Kirkwood and Sterne, 2nd edition, 2003) (link\nStatistiske metoder i medisin og helsefag (Aalen, Frigessi, Moger, Scheel, Skovlund og Veierød, 2 utg, 2018) (link)\n\n\n\nVideos\nInstall R and Rstudio YouTube videos"
  },
  {
    "objectID": "lab/overview.html",
    "href": "lab/overview.html",
    "title": "R Lab and Code",
    "section": "",
    "text": "Welcome! Here you will find material for R lab and code for this course. Lecture notes, videos and other resources can be found in Course material page."
  },
  {
    "objectID": "lab/overview.html#set-up",
    "href": "lab/overview.html#set-up",
    "title": "R Lab and Code",
    "section": "Set-up",
    "text": "Set-up\nPlease refer to (link to setup) page for more information.\n\nData and R scripts\nDatasets used for this course can be found at insert path.\nR scripts used for each section can be downloaded directly at insert path."
  },
  {
    "objectID": "lab/overview.html#lab",
    "href": "lab/overview.html#lab",
    "title": "R Lab and code",
    "section": "Lab",
    "text": "Lab\nPLAN: use hide-code? or prepare 2 sets, one for demonstration in class, another for home-exercise. for the home exercise, can attach worked solution at the bottom.\n\n\n\n\n\n\nTitle\n\n\nDescription\n\n\n\n\n\n\nIntroduction to R\n\n\nGet started in Rstudio, navigation, data types, data import ant export\n\n\n\n\nExploratory data analysis (Part I)\n\n\nExploring a dataset, basic data manipulation, descriptive statistics\n\n\n\n\nExploratory data analysis (Part II)\n\n\nMore on data manipulation, visualisation\n\n\n\n\nStatistical inference\n\n\nConfidence interval, hypothesis testing\n\n\n\n\nT test\n\n\nR lab 1\n\n\n\n\nCategorical data analysis\n\n\nContingency table, chi-square test, proportions\n\n\n\n\nNon-parametric tests\n\n\nWilcoxon signed rank, rank sum test\n\n\n\n\nSample size and power\n\n\nR lab 1\n\n\n\n\nRegression analysis\n\n\nLinear regression, logistic regression\n\n\n\n\nSurvival analysis\n\n\nKaplan-Meier curve, log rank tests\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "lab/overview.html#useful-resources",
    "href": "lab/overview.html#useful-resources",
    "title": "R Lab and Code",
    "section": "Useful resources",
    "text": "Useful resources\nList of commands that are useful for this course: list of commands\nBook (Wickham et al) R for Data Science (2e)"
  },
  {
    "objectID": "lab/lab_survival.html",
    "href": "lab/lab_survival.html",
    "title": "Survival analysis",
    "section": "",
    "text": "Melanoma\n(This is the example 2 in the exercises)\nFirst we load the dataset, and check what columns are there.\n\nlibrary(survival)\n\nmelanoma <- haven::read_dta('data/melanoma.dta')\n\nhead(melanoma)\n\n# A tibble: 6 × 12\n  status    lifet…¹ ulcer…² tumor…³ gender   age group…⁴ logar…⁵  SUR_1     SE_1\n  <dbl+lbl>   <dbl> <dbl+l>   <dbl> <dbl+> <dbl> <dbl+l>   <dbl>  <dbl>    <dbl>\n1 4 [Death…  0.0274 1 [Yes]    6.76 2 [m]     76 3 [5+ …   1.91  NA     NA      \n2 4 [Death…  0.0822 2 [No]     0.65 2 [m]     56 1 [0-2…  -0.431 NA     NA      \n3 2 [Censo…  0.0959 2 [No]     1.34 2 [m]     41 1 [0-2…   0.293 NA     NA      \n4 4 [Death…  0.271  2 [No]     2.9  1 [f]     71 2 [2-5…   1.06  NA     NA      \n5 1 [Death…  0.507  1 [Yes]   12.1  2 [m]     52 3 [5+ …   2.49   0.995  0.00496\n6 1 [Death…  0.559  1 [Yes]    4.84 2 [m]     28 2 [2-5…   1.58   0.990  0.00700\n# … with 2 more variables: SUR_2 <dbl>, SE_2 <dbl>, and abbreviated variable\n#   names ¹​lifetime, ²​ulceration, ³​tumor_thickness, ⁴​grouped_tumor_thickness,\n#   ⁵​logarithm_of_tumor_thickness\n\ncolnames(melanoma)\n\n [1] \"status\"                       \"lifetime\"                    \n [3] \"ulceration\"                   \"tumor_thickness\"             \n [5] \"gender\"                       \"age\"                         \n [7] \"grouped_tumor_thickness\"      \"logarithm_of_tumor_thickness\"\n [9] \"SUR_1\"                        \"SE_1\"                        \n[11] \"SUR_2\"                        \"SE_2\"                        \n\n\n\na) Recode variable\nWe only need “death from melanoma” or else, hence we need to recode the status variable which originally had three categories.\n\n# if status == 1, code 1; otherwise, code 0\n# this indicates whether deaths from melanoma\ndeath <- ifelse(melanoma$status == 1, 1, 0)\n\n# check if the labels are correct\ntable(death)\n\ndeath\n  0   1 \n148  57 \n\ntable(melanoma$status)\n\n\n  1   2   4 \n 57 134  14 \n\n\nYou can see that the category melanoma$status == 1 should match death == 1, and melanoma$status of 2 and 4 are merged together and coded as death == 0.\n\n\nb) Kaplan-Meier plot\n\n# take lifetime variable\nlifetime <- melanoma$lifetime\n\n\nkm_fit <- survfit(Surv(lifetime, death) ~ 1)\nplot(km_fit)\n\n# add title and text\ntitle(main = 'Kaplan-Meier survival estimate', \n      xlab = 'Time', \n      ylab = 'Survival probability')\n\n\n\n\nNow we check only time 1, 2, 5.\n\n# time 1, 2, 5\ntme <- c(1, 2, 5)\nsummary(km_fit, times = tme)\n\nCall: survfit(formula = Surv(lifetime, death) ~ 1)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1    193       6    0.970  0.0120        0.947        0.994\n    2    183       9    0.925  0.0187        0.889        0.962\n    5    122      30    0.769  0.0303        0.712        0.831\n\n\n\n\nc) Compare two genders\n\n# gender == 1: female; gender == 2: male\ngender <- melanoma$gender\n\n\nkm_fit_gender <- survfit(Surv(lifetime, death) ~ gender)\nplot(km_fit_gender, col = c('blue', 'red'))\ntitle(main = 'Kaplan-Meier survival estimate: stratify by gender', \n      xlab = 'Time', \n      ylab = 'Survial probability')\n\n# add legend\nlegend( 'bottomleft', \n       legend = c('Female', 'Male'), \n       lty = c('solid', 'solid'), \n       col = c('blue','red'))\n\n\n\n\nNow we test the difference with log-rank test\n\n# test difference with logrank test \nsurvdiff(Surv(lifetime, death) ~ gender)\n\nCall:\nsurvdiff(formula = Surv(lifetime, death) ~ gender)\n\n           N Observed Expected (O-E)^2/E (O-E)^2/V\ngender=1 126       28     37.1      2.25      6.47\ngender=2  79       29     19.9      4.21      6.47\n\n Chisq= 6.5  on 1 degrees of freedom, p= 0.01 \n\n\n\n\nd) Compare tumor thickness\nFirst we do some data processing\n\n# check the original data type \nmelanoma$grouped_tumor_thickness\n\n<labelled<double>[205]>: Thickness group\n  [1] 3 1 1 2 3 2 3 2 3 3 2 1 2 2 2 3 3 3 3 3 3 2 2 2 2 1 3 2 2 2 1 2 1 3 3 2 2\n [38] 2 1 2 2 2 3 1 2 1 2 3 1 1 2 1 1 1 1 2 1 1 1 3 1 1 1 1 1 1 1 1 3 1 1 1 2 1\n [75] 1 2 1 2 1 1 1 1 2 1 1 1 1 1 2 1 1 2 2 1 2 1 1 3 1 3 2 2 1 1 2 1 2 1 1 2 2\n[112] 2 2 1 1 1 1 1 1 1 1 3 3 1 3 2 2 1 1 3 1 2 2 1 1 1 2 1 2 1 3 1 2 1 1 2 1 1\n[149] 1 1 1 1 1 2 1 1 3 1 1 1 1 3 1 1 2 1 2 2 1 1 2 1 2 2 2 1 1 1 1 1 1 2 2 1 1\n[186] 3 1 1 1 3 3 1 2 2 1 1 1 2 1 1 3 3 1 2 2\n\nLabels:\n value  label\n     1 0-2 mm\n     2 2-5 mm\n     3  5+ mm\n\n# you can code them so that the data is more readable\ngrouped_tumor_thickness <- factor(melanoma$grouped_tumor_thickness, \n                           levels = c('1','2', '3'),\n                           labels = c('0-2 mm', '2-5 mm', '5+ mm'))\n\n# check if it is coded correctly\ntable(grouped_tumor_thickness)\n\ngrouped_tumor_thickness\n0-2 mm 2-5 mm  5+ mm \n   109     64     32 \n\ntable(melanoma$grouped_tumor_thickness)\n\n\n  1   2   3 \n109  64  32 \n\n\nNow we plot the KM plot, and carry out a log-rank test\n\nkm_fit_tumor <- survfit(Surv(lifetime, death) ~ grouped_tumor_thickness)\nplot(km_fit_tumor, col = c('blue', 'red', 'forestgreen'))\n\ntitle(main = 'Kaplan-Meier survival estimate: stratify by tumor thickness', \n      xlab = 'Time', \n      ylab = 'Survial probability')\n\n# add legend\nlegend( 'bottomleft', \n        legend = c('0-2 mm', '2-5 mm', '5+ mm'), \n        lty = c('solid', 'solid', 'solid'), \n        col = c('blue','red', 'forestgreen'))\n\n\n\n# test difference with logrank test \nsurvdiff(Surv(lifetime, death) ~ grouped_tumor_thickness)\n\nCall:\nsurvdiff(formula = Surv(lifetime, death) ~ grouped_tumor_thickness)\n\n                                 N Observed Expected (O-E)^2/E (O-E)^2/V\ngrouped_tumor_thickness=0-2 mm 109       13    33.75     12.75     31.36\ngrouped_tumor_thickness=2-5 mm  64       30    16.39     11.30     15.88\ngrouped_tumor_thickness=5+ mm   32       14     6.86      7.42      8.45\n\n Chisq= 31.6  on 2 degrees of freedom, p= 1e-07 \n\n\n\n\n\nLength of hospital stay\n(This is the exercise 3 from the exercise for day 7)\n\nliggetid <- haven::read_dta('data/liggetid.dta')\nhead(liggetid)\n\n# A tibble: 6 × 21\n   faar fmaan  fdag innaar innmaan inndag utaar utmaan utdag kjoenn     kom_fra \n  <dbl> <dbl> <dbl>  <dbl>   <dbl>  <dbl> <dbl>  <dbl> <dbl> <dbl+lbl>  <dbl+lb>\n1  1906     3     4   1987       3      5    87      3    18 0 [kvinne] 1 [hjem]\n2  1891     4     3   1987       3      6    87      3    23 0 [kvinne] 1 [hjem]\n3  1908     9     6   1987       3     10    87      3    16 0 [kvinne] 1 [hjem]\n4  1910     1    11   1987       3     11    87      3    25 1 [mann]   1 [hjem]\n5  1907     1     6   1987       3     13    87      3    30 0 [kvinne] 1 [hjem]\n6  1901    12    19   1987       3     13    87      4     2 0 [kvinne] 1 [hjem]\n# … with 10 more variables: slag <dbl+lbl>, alder <dbl>, liggetid <dbl>,\n#   lnliggti <dbl>, kom_fra2 <dbl>, kom_fra3 <dbl>, kom_fra4 <dbl>,\n#   kom_fra5 <dbl>, kom_fra6 <dbl>, status <dbl>\n\ncolnames(liggetid)\n\n [1] \"faar\"     \"fmaan\"    \"fdag\"     \"innaar\"   \"innmaan\"  \"inndag\"  \n [7] \"utaar\"    \"utmaan\"   \"utdag\"    \"kjoenn\"   \"kom_fra\"  \"slag\"    \n[13] \"alder\"    \"liggetid\" \"lnliggti\" \"kom_fra2\" \"kom_fra3\" \"kom_fra4\"\n[19] \"kom_fra5\" \"kom_fra6\" \"status\"  \n\n# all status are 1 \nstatus <- liggetid$status\n\n\na) Length of stay vs gender\n\n# length of stay (los) vs gender\nlos <- liggetid$liggetid\nhead(los)\n\n[1] 13 17  6 14 17 20\n\n# can choose to recode; or leave as it is;\n# gender == 0: female; gender == 1: male\ngender <- liggetid$kjoenn\nhead(gender)\n\n<labelled<double>[6]>\n[1] 0 0 0 1 0 0\n\nLabels:\n value  label\n     0 kvinne\n     1   mann\n\n# fit km \nkm_liggetid_gender <- survfit(Surv(los, status) ~ gender)\n\nplot(km_liggetid_gender, col = c('blue', 'red'))\n\ntitle(main = 'Kaplan-Meier survival estimate: stratify by gender', \n      xlab = 'Time', \n      ylab = 'Survial probability')\n\n# add legend\nlegend( 'topright', \n        legend = c('Female', 'Male'), \n        lty = c('solid', 'solid'), \n        col = c('blue','red'))\n\n\n\n\nNow we do log-rank test\n\n# log rank test \nsurvdiff(Surv(los, status) ~ gender)\n\nCall:\nsurvdiff(formula = Surv(los, status) ~ gender)\n\nn=1138, 1 observation deleted due to missingness.\n\n           N Observed Expected (O-E)^2/E (O-E)^2/V\ngender=0 714      714      799      9.06      31.9\ngender=1 424      424      339     21.36      31.9\n\n Chisq= 31.9  on 1 degrees of freedom, p= 2e-08 \n\n\n\n\nb) Length of stay vs stroke\n\n# length of stay vs stroke\n# slag == 1: yes, slag == 2: no\nstroke <- liggetid$slag\n\n# fit km \nkm_liggetid_stroke <- survfit(Surv(los, status) ~ stroke)\n\nplot(km_liggetid_stroke, col = c('blue', 'red'))\n\ntitle(main = 'Kaplan-Meier survival estimate: stratify by stroke', \n      xlab = 'Time', \n      ylab = 'Survial probability')\n\n# add legend\nlegend( 'topright', \n        legend = c('Stroke: yes', 'Stroke: no'), \n        lty = c('solid', 'solid'), \n        col = c('blue','red'))\n\n\n\n\n\n# log rank test\nsurvdiff(Surv(los, status) ~ stroke)\n\nCall:\nsurvdiff(formula = Surv(los, status) ~ stroke)\n\nn=1054, 85 observations deleted due to missingness.\n\n           N Observed Expected (O-E)^2/E (O-E)^2/V\nstroke=0 891      891      864     0.814      4.61\nstroke=1 163      163      190     3.714      4.61\n\n Chisq= 4.6  on 1 degrees of freedom, p= 0.03"
  },
  {
    "objectID": "lab/lab_intro_r.html",
    "href": "lab/lab_intro_r.html",
    "title": "Introduction to R",
    "section": "",
    "text": "R is a language and environment for statistical computing, data analysis, visualisation and graphics and many more. It is a free and open source software, under the terms of GNU General Public License.\nR runs on a wide variety of platforms, including Windows, Linux and MacOS.\nThe latest R version is 4.2.3 (2023-03-15), “Shortstop Beagle”."
  },
  {
    "objectID": "lab/lab_intro_r.html#r-in-a-nutshell",
    "href": "lab/lab_intro_r.html#r-in-a-nutshell",
    "title": "Introduction to R",
    "section": "R in a nutshell",
    "text": "R in a nutshell\nR is a language and environment for statistical computing, data analysis, visualisation and graphics and many more. It is a free and open source software, under the terms of GNU General Public License.\nR runs on a wide variety of platforms, including Windows, Linux and MacOS.\nThe latest R version is 4.2.3 (2023-03-15), “Shortstop Beagle”.\n\nRStudio and Posit\nRStudio is a free and open-source IDE (integrated development environment). RStudio IDE is developed by Posit, previously RStudio PBC.\nIt is possible to download RStudio to your laptop or desktop; or use RStudio Cloud (need internet connection).\n4 Panels, use screenshot\n\n\nGetting help\n\nUse Google well! There are a lot of discussions in forums such as StackOverflow\nCheatsheets made by Posit and community\nType ?functionName in the console\nPackage vignettes (longer format of documentation)"
  },
  {
    "objectID": "lab/lab_intro_r.html#vectors",
    "href": "lab/lab_intro_r.html#vectors",
    "title": "Introduction to R",
    "section": "Vectors",
    "text": "Vectors\nA vector is a list of values; it can be numeric, and also characters and logical.\nTo create a vector, use function c().\n\n# numeric\nnum_vector <- c(1, 2, 3, 4, 5)\nnum_vector\n\n[1] 1 2 3 4 5\n\n# character\nchar_vector <- c('student_a', 'student_b', 'student_c')\nchar_vector\n\n[1] \"student_a\" \"student_b\" \"student_c\"\n\n# logical \nlogical_vector <- c(T, F, T, F)\nlogical_vector\n\n[1]  TRUE FALSE  TRUE FALSE\n\n\nThere are some shortcuts to create a sequence of values; not required to learn, but very useful.\n\n# numeric\n# num_vector <- c(1, 2, 3, 4, 5)\nnum_vector <- 1:5 # from 1 to 5\nseq(from = 1, to = 11, by = 2) # from 1 to 11, with 2 between each\n\n[1]  1  3  5  7  9 11\n\nrep(1, 5) # repeat 1 for 5 times\n\n[1] 1 1 1 1 1\n\n# character\n# char_vector <- c('student_a', 'student_b', 'student_c')\nchar_vector <- paste0('student_', c('a', 'b', 'c'))\n\n\n\n\n\n\n\nTypes of elements in a vector\n\n\n\nIn a vector, types of the elements must be the same. If you try to combine multiple types of variables in the same vector, such as a numeric number and a character, R will try to convert them into the same type.\nTry to combine the following values into a vector, and see what happens.\n\n1.52, “student_a”\n1.52, TRUE (logical)\nTRUE, “student_a”\n\n\n\n\nCombine multiple vectors\nYou can combine multiple vectors using c(). For example, vec1 has 3 elements, vec2 has 2 elements (assuming that they are of the same type), combining them gives 5 elements.\n\nvec1 <- c(1, 3, 5)\nvec2 <- c(100, 101)\nc(vec1, vec2)\n\n[1]   1   3   5 100 101\n\n# you can also save it into a new variable, \n# so that you can access it in the future\nvec_combined <- c(vec1, vec2)\nvec_combined\n\n[1]   1   3   5 100 101"
  },
  {
    "objectID": "lab/lab_intro_r.html#matrix",
    "href": "lab/lab_intro_r.html#matrix",
    "title": "Introduction to R",
    "section": "Matrix",
    "text": "Matrix\nA matrix can be thought of as a stack of vectors. When you collect data from \\(n\\) patients (or subjects), you measure a few aspects on each patient such as age, sex, height and smoking. Let’s say you have measured \\(p\\) aspects. This forms a matrix of size \\(n \\times p\\).\nYou might not need to create a matrix from scratch in R (because the focus of this course is data analysis); but it is helpful to understand some basic data manipulation commands.\nYou can create a matrix using matrix(), with some parameters:\n\nmatrix_1 <- matrix(data = c(1, 2, 3, 4), nrow = 2, ncol = 2, byrow = T)\nmatrix_1\n\n     [,1] [,2]\n[1,]    1    2\n[2,]    3    4\n\n\nYou can also create a matrix by combining two vectors of the same size, using cbind() or rbind(), which stands for “column bind” and “rowbind”.\n\nvec1 <- c(1, 2)\nvec2 <- c(3, 4)\n\n# bind by columnn\nmatrix_c <- cbind(vec1, vec2)\nmatrix_c\n\n     vec1 vec2\n[1,]    1    3\n[2,]    2    4\n\n# bind by row\nmatrix_r <- rbind(vec1, vec2)\nmatrix_r\n\n     [,1] [,2]\nvec1    1    2\nvec2    3    4"
  },
  {
    "objectID": "lab/lab_intro_r.html#dataframe",
    "href": "lab/lab_intro_r.html#dataframe",
    "title": "Introduction to R",
    "section": "Dataframe",
    "text": "Dataframe\nDataframe, data.frame is a format of data commonly used in data analysis with R and python. It can be considered as a matrix, but allows a mixture of data types, such as numeric and categorical measurements (age and sex).\nIn this course, you will mostly be working with dataframes.\nWe create a small dataframe of 3 subjects:\n\nSubject 1 is a 20 years-old male who has covid\nSubject 2 is a 50 years-old female who has covid\nSubject 3 is a 32 years-old male who does not have covid\n\nThis is how you can present the dataframe, where each column has a different data type.\n\nmini_data <- data.frame(\n  age = c(20, 50, 32), \n  sex = c('male', 'female', 'male'), \n  has_covid = c(T, T, F)\n)\nmini_data\n\n  age    sex has_covid\n1  20   male      TRUE\n2  50 female      TRUE\n3  32   male     FALSE"
  },
  {
    "objectID": "lab/lab_intro_r.html#dimension-of-your-data",
    "href": "lab/lab_intro_r.html#dimension-of-your-data",
    "title": "Introduction to R",
    "section": "Dimension of your data",
    "text": "Dimension of your data\nYou can find the size of a vector with length().\nFor a matrix or dataframe, you can use dim(). It will return nrow ncol, number of rows and number of columns.\n\nvec1 <- c(1, 2)\nlength(vec1)\n\n[1] 2\n\n# matrix\nmat <- matrix(data = c(1, 2, 3, 4), nrow = 2, byrow = 2)\ndim(mat)\n\n[1] 2 2\n\n# dataframe\ndim(mini_data)\n\n[1] 3 3\n\n\n\n\n\n\n\n\ndim() or length()\n\n\n\nIf you use dim() on a vector, it returns NULL. Given that a vector is just a matrix with 1 row (or column), this seems insensible.\nNonetheless, dim() works on matrix objects. if you convert the vector into a matrix with nrow =1 or ncol = 1, dim() will work.\nIf you use length() on a matrix, it will return the total number of elements, i.e. ncol times nrow.\n\n\nYou can also use nrow(), ncol() to get the number of rows and columns explicitly.\n\n# ncol, nrow\n# dim(mini_data)\nnrow(mini_data)\n\n[1] 3\n\nncol(mini_data)\n\n[1] 3"
  },
  {
    "objectID": "lab/lab_intro_r.html#accessing-elements-in-your-data",
    "href": "lab/lab_intro_r.html#accessing-elements-in-your-data",
    "title": "Introduction to R",
    "section": "Accessing elements in your data",
    "text": "Accessing elements in your data\nFor a vector, you can access\n\nan element at a given position\nmultiple elements at given positions\n\nelements beyond, or below a certain element\n\nSometimes you might need to combine previous knowledge to get what you want (e.g. to know how many elements in total there are). But not required now.\n\nletters <- c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h')\n\n# 3rd letter\nletters[3]\n\n[1] \"c\"\n\n# 3rd, and 5th\nletters[c(3, 5)]\n\n[1] \"c\" \"e\"\n\n# letters beyond 4\nletters[5:8] # or, letters[5:length(letters)]\n\n[1] \"e\" \"f\" \"g\" \"h\"\n\n\nFor a matrix,\n\nmatrix[r, c] to get the element on \\(r\\)-th row, \\(c\\)-th column.\nmatrix[r, ], matrix[, c] to get all the elements on \\(r\\)-th row or \\(c\\)-th column\n\n\nmat_3by3 <- matrix(data = 1:9, nrow = 3, byrow = T)\nmat_3by3\n\n     [,1] [,2] [,3]\n[1,]    1    2    3\n[2,]    4    5    6\n[3,]    7    8    9\n\n# element (2,3)\nmat_3by3[2, 3]\n\n[1] 6\n\n# first row\nmat_3by3[1,]\n\n[1] 1 2 3\n\n\nFor a dataframe,\n\nyou can use indices (row, col) in the same way as matrices above;\nuse data$column_name, or data['column_name'] to access the entire column\n\nConventionally, each row is a subject, and each columnn is a variable (or aspect of measurement, feature, characteristic, risk factor etc).\n\nmini_data\n\n  age    sex has_covid\n1  20   male      TRUE\n2  50 female      TRUE\n3  32   male     FALSE\n\n# first row \nmini_data[1, ]\n\n  age  sex has_covid\n1  20 male      TRUE\n\n# second col\nmini_data[, 2]\n\n[1] \"male\"   \"female\" \"male\"  \n\n# via column name \nmini_data$age\n\n[1] 20 50 32\n\nmini_data['age']\n\n  age\n1  20\n2  50\n3  32"
  },
  {
    "objectID": "lab/lab_intro_r.html#modify-existing-data",
    "href": "lab/lab_intro_r.html#modify-existing-data",
    "title": "Introduction to R",
    "section": "Modify existing data",
    "text": "Modify existing data\n\n\n\n\n\n\nKeep your original data safe!\n\n\n\nModifying an existing data is easy, but you should be aware of the risks. In this class we only modify data we created in the class so there is little risk, but you might have your own datasets to analyse in the future.\nYou should keep your original data in a safe place, and work on copies of it.\nVersion control is a good skill to learn.\n\n\n\n# vector\n# make e into E \nletters[5] <- 'E'\nletters\n\n[1] \"a\" \"b\" \"c\" \"d\" \"E\" \"f\" \"g\" \"h\"\n\n# matrix\n# make (1, 1) 20\nmat_3by3[1, 1] # originally was 1\n\n[1] 1\n\nmat_3by3[1, 1] <- 20\nmat_3by3\n\n     [,1] [,2] [,3]\n[1,]   20    2    3\n[2,]    4    5    6\n[3,]    7    8    9\n\n# dataframe\n# make so that subject 2 does not have covid\nmini_data\n\n  age    sex has_covid\n1  20   male      TRUE\n2  50 female      TRUE\n3  32   male     FALSE\n\nmini_data$has_covid[2] <- F\nmini_data\n\n  age    sex has_covid\n1  20   male      TRUE\n2  50 female     FALSE\n3  32   male     FALSE"
  },
  {
    "objectID": "lab/lab_intro_r.html#basic-calculations",
    "href": "lab/lab_intro_r.html#basic-calculations",
    "title": "Introduction to R",
    "section": "Basic calculations",
    "text": "Basic calculations\nr as calculator (use console first; use script AFTER project and workspace mgmt!)\nexp, division\n\n# assign values to variables a, b, c\na <- 3\nb <- 4\nc <- 7\n\n# calculate the average of a,b,c\n# output directly\n(a+b+c)/3\n\n[1] 4.666667\n\n# or, save into a new variable d\nd <- (a+b+c)/3\nd\n\n[1] 4.666667"
  },
  {
    "objectID": "lab/lab_inf_ci.html",
    "href": "lab/lab_inf_ci.html",
    "title": "Statistical inference",
    "section": "",
    "text": "Hypothesis testing\n\nError\nType I error: conclude that there is an effect when there is not (false positive).\n\ncontrolled by significance level, \\(\\alpha\\)\nusually choose \\(\\alpha = 0.05\\)\n\nType II error: conclude there is not an effect when there really is (false negative).\n\npower: \\(1-\\beta\\)\na minimum for “good” power is usually 80%; i.e. 80% chance of correctly rejecting the null hypothesis if there is an effect."
  },
  {
    "objectID": "lab/lab_regression.html",
    "href": "lab/lab_regression.html",
    "title": "Regression analysis",
    "section": "",
    "text": "Logistic regression\n(Dataset birth might be switched out)\n\n# load data\nbirth_data <- haven::read_dta('data/birth.dta')\n\n# print the first rows of the data set\nhead(birth_data)\n\n# A tibble: 6 × 12\n     id low            age   lwt eth       smk   ptl ht      ui        fvt   ttv\n  <dbl> <dbl+lbl>    <dbl> <dbl> <dbl+l> <dbl> <dbl> <dbl+l> <dbl+l> <dbl> <dbl>\n1     4 1 [bwt < 25…    28   120 3 [oth…     1     1 0 [no]  1 [yes]     0     0\n2    10 1 [bwt < 25…    29   130 1 [whi…     0     0 0 [no]  1 [yes]     2     0\n3    11 1 [bwt < 25…    34   187 2 [bla…     1     0 1 [yes] 0 [no]      0     0\n4    13 1 [bwt < 25…    25   105 3 [oth…     0     1 1 [yes] 0 [no]      0     0\n5    15 1 [bwt < 25…    25    85 3 [oth…     0     0 0 [no]  1 [yes]     0     4\n6    16 1 [bwt < 25…    27   150 3 [oth…     0     0 0 [no]  0 [no]      0     5\n# ℹ 1 more variable: bwt <dbl>\n\n\n\nFit a logistic regression model for low and age\n\n# low ~ age \n\nlr_low_age <- glm(low ~ age, data = birth_data, family = 'binomial')\nsummary(lr_low_age)\n\n\nCall:\nglm(formula = low ~ age, family = \"binomial\", data = birth_data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.0402  -0.9018  -0.7754   1.4119   1.7800  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  0.38458    0.73212   0.525    0.599\nage         -0.05115    0.03151  -1.623    0.105\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 234.67  on 188  degrees of freedom\nResidual deviance: 231.91  on 187  degrees of freedom\nAIC: 235.91\n\nNumber of Fisher Scoring iterations: 4\n\n\n\n# the result regresssion coefficient is not odds ratio\nlr_low_age$coefficients\n\n(Intercept)         age \n 0.38458192 -0.05115294 \n\n# regression coefficients can also be extracted in this way:\ncoefficients(lr_low_age)\n\n(Intercept)         age \n 0.38458192 -0.05115294 \n\n# coef(lr_low_age)\n\n# confidence interval for age and intercept\nconfint(lr_low_age)\n\n                 2.5 %      97.5 %\n(Intercept) -1.0336270 1.847399861\nage         -0.1150799 0.008986436\n\n\n\n# to get odds ratio, exponentiate \nexp(coef(lr_low_age))\n\n(Intercept)         age \n  1.4690000   0.9501333 \n\nexp(confint(lr_low_age))\n\n                2.5 %   97.5 %\n(Intercept) 0.3557144 6.343305\nage         0.8912949 1.009027"
  },
  {
    "objectID": "course_material/notes_diagnostic_tests.html",
    "href": "course_material/notes_diagnostic_tests.html",
    "title": "Evaluation of Diagnostic Tests",
    "section": "",
    "text": "Topics:\nBook and resources:"
  },
  {
    "objectID": "course_material/notes_diagnostic_tests.html#confusion-matrix",
    "href": "course_material/notes_diagnostic_tests.html#confusion-matrix",
    "title": "Evaluation of Diagnostic Tests",
    "section": "Confusion matrix",
    "text": "Confusion matrix\nDenote the subjects with the condition as \\(P\\), and subjects without the condition as \\(N\\).\nTotal population: \\(P+N\\)\nPrevalence (of the condition) is defined as: \\(\\frac{P}{P+N}\\)\n\n\n\n\n\n\n\n\n\n\nPredicted Positive\nPredicted Negative\nTotal\n\n\n\n\nWith condition\nTrue Positive TP\nFalse Negative FN\n\\(P = TP + FN\\)\n\n\nWithout condition\nFalse Positive FP\nTrue Negative TN\n\\(N=FP + TN\\)\n\n\nTotal\n\\(P_{\\text{predicted}}=TP+FP\\)\n\\(N_{\\text{predicted}}=FN + TN\\)\n\n\n\n\nSensitivity of a diagnostic test is the probability of revealing that a person has the condition. It is also known as true positive rate (TPR), as it is the proportion of true positives.\n\\[\\text{Sensitivity}= \\frac{TP}{P} = \\frac{TP}{TP+FN}\\]\nSpecificity is the probability of revealing that a person does not have the condition (i.e. healthy). It is also known as true negative rate.\n\\[\\text{Specificity} = \\frac{TN}{N} = \\frac{TN}{TN + FP}\\]\nPositive predictive value (PPV): probability that the person with the condition was given a positive test result\n\\[PPV = \\frac{TP}{P_{predicted}} = \\frac{TP}{TP + FP}\\]\nNegative predictive value (NPV): probability that the person without the condition (i.e. healthy) was give a negative test result.\n\\[NPV = \\frac{TN}{N_{predicted}} = \\frac{TN}{TN + FN}\\]\n\n\n\n\n\n\nExample: Mammography\n\n\n\n\n\n(From the Norwegian Medical Journal, 1990) 372 women with a lump in the breast have been referred to a surgical clinic.\n\n\n\n\nMammography malign\nMammography benign\n\n\n\n\nFinal diagnosis malign\n22\n3\n\n\nFinal diagnosis benign\n16\n331\n\n\n\nIdentify the positive test result (Mammography malign), and positive condition (Final diagnosis malign).\nSensitivity: \\(22/(22+3) = 0.88\\)\nSpecificity: \\(331/(331+16) = 0.95\\)\nPositive predictive value: \\(22/(22+16) = 0.58\\)\nNegative predictive value: \\(331/(331+3) = 0.99\\)"
  },
  {
    "objectID": "course_material/notes_diagnostic_tests.html#diagnostic-tests-and-prevalence",
    "href": "course_material/notes_diagnostic_tests.html#diagnostic-tests-and-prevalence",
    "title": "Evaluation of Diagnostic Tests",
    "section": "Diagnostic tests and prevalence",
    "text": "Diagnostic tests and prevalence\nThe concepts in diagnostic testing can be formulated in the form of conditional probabilities:\n\nSensitivity: \\(P(\\text{pos}|\\text{ill})\\)\nSpecificity: \\(P(\\text{neg}|\\text{healthy})\\)\nPositive predictive value: \\(P(\\text{ill}|\\text{pos})\\)\nNegative predictive value: \\(P(\\text{healthy}|\\text{neg})\\)\n\nBayes’ theorem can be applied to compute PPV and NPV from sensitivity, specificity and prevalence:\n\\[PPV = \\frac{\\text{sens} \\cdot \\text{prev}}{\\text{sens} \\cdot \\text{prev} + (1-\\text{spes}) \\cdot (1-\\text{prev})}\\]\n\\[NPV = \\frac{\\text{spes} \\cdot (1-\\text{prev}) }{(1-\\text{sens}) \\cdot \\text{prev} + \\text{spes} \\cdot (1-\\text{prev})}\\]\n\n\n\n\n\n\nDerivation of the PPV formula using Bayes’ law\n\n\n\n\n\n\\[\n\\begin{aligned}PPV = P(\\text{ill}|\\text{pos}) & = \\frac{P(\\text{pos}|\\text{ill}) \\cdot P(\\text{ill})}{P(\\text{pos})}\\\\                               & = \\frac{P(\\text{pos}|\\text{ill}) \\cdot P(\\text{ill})}{P(\\text{pos}|\\text{ill}) \\cdot P(\\text{ill}) +  P(\\text{pos}|\\text{healthy}) \\cdot P(\\text{healthy})}\\\\ & =\\frac{\\text{sens} \\cdot \\text{prev}}{\\text{sens} \\cdot \\text{prev} + (1-\\text{spes}) \\cdot (1-\\text{prev})}\\end{aligned}\n\\]\nExercise: Try to derive the formula for \\(NPV\\) in a similar way.\n\n\n\n\n\n\n\n\n\nExample: HIV testing\n\n\n\n\n\nWe want to test for antibodies of the HIV virus.\n\nPositive result: test shows antibodies\nNegative result: test does not show antibodies\n\nThe test result may be wrong.\nA false positive might come from antibodies from related virus, but not HIV. The probability of error is 0.2%.\nA false negative might be that antibodies are not yet produced in sufficient quantity, hence are not detected by the test. The probability of error is 2%.\nAssume that prevalence of HIV is 0.1%.\nWhat is the probability of a person having HIV, if he got a positive test result?\nWhat is the probability of a person not having HIV, if he got a negative test result?\nRecall the relation between sensitivity and false negative, and between specificity with false positive.\nWe know the following information about the test:\n\nfalse negative rate \\(FNR = 2\\%\\): sensitivity \\(\\text{sens} = 1-2\\% = 98\\%\\)\nfalse positive rate \\(FPR = 0.2\\%\\): specificity \\(\\text{spec} = 1-0.2\\% = 99.8\\%\\)\n\nFor 100 000 persons,\n\nNumber of HIV infected (positive condition): \\(100000 \\times 0.001 = 100\\)\nTrue positives: \\(100 \\times 0.98 = 98\\)\nFalse negatives: 2\nNumber of not HIV infected (negative condition): \\(100000-100 = 99900\\)\nFalse positives: \\(99900 \\times 0.002 = 199.8\\), say \\(200\\)\nTrue negatives: \\(99900 \\times 0.998 = 99700\\)\nPositive predictive value, \\(PPV = TP/(TP+FP) = 98/(98+200)= 0.329\\)\nNegative predictive value, \\(NPV = TN/(TN+FN) = 99700/(99700+2) = 0.9999\\)\n\n\\(PPV = \\frac{\\text{sens} \\cdot \\text{prev}}{\\text{sens} \\cdot \\text{prev} + (1-\\text{spes}) \\cdot (1-\\text{prev})} = \\frac{0.98 \\times 0.001}{0.98 \\times 0.001 + 0.002 \\times 0.999} = 0.329\\)\n\\(NPV = \\frac{\\text{spes} \\cdot (1-\\text{prev}) }{(1-\\text{sens}) \\cdot \\text{prev} + \\text{spes} \\cdot (1-\\text{prev})} = \\frac{0.998 \\times 0.999}{0.98 \\times 0.001 + 0.998 \\times 0.999} = 0.999\\)\nWe can also use the formula as follows:"
  },
  {
    "objectID": "lab/lab_eda_part1.html",
    "href": "lab/lab_eda_part1.html",
    "title": "Exploratory data analysis (Part I)",
    "section": "",
    "text": "Might be useful to have an outline and study goals"
  },
  {
    "objectID": "for_instructors/how-to.html",
    "href": "for_instructors/how-to.html",
    "title": "MF9130E - V23",
    "section": "",
    "text": "Where are my content\nLecture notes\n\ncourse_material/course_material_overview.qmd: overview with a table. this is where you edit the links to each topic\nnotes_diagnostic_tests.qmd: this is an example of qmd notes. renders to html.\nexample.pdf: an example of pdf notes. downloadable by students directly from the browser\n\nLab content\n\nlab/code/ stores code\nlab/data/ stores data\n\n\n\nThe course website\nThe website is linked to the github repository, specifically,\n\nHome links to index.qmd\nGet started links to get_started/get_started.qmd\nCourse material links to course_material/course_material_overview.qmd\nR labs and code links to lab/overview.qmd, which links a bunch of sub material\n\nThe overall appearance is controlled by _quarto.yml.\n\n\nHow to modify the content\nThe website is made by quarto, which is a better version of Rmarkdown. The way code chunk works is exactly the same as Rmarkdown (only that it supports a few more languages in the same file).\nYou might need to install quarto and upgrade Rstudio to the latest version, to be able to render the documents by yourself.\n\nRecommended workflow\n\nClone the repo to your local\nMake a branch\ntest render index.qmd, see if the whole website renders\nchange something on the branch\ntest render the qmd files you modified. Make sure that the path are set properly so that files can be loaded properly\npush to remote\nmake a pull request, someone will take over from here\n\n\n\nDeploy changes to the website (avoid this if you are not sure!)\npush all modifications to github, the site will update itself momentarily (after the CI/CD are successful)\nYou can also let me know if you need any help with the website or text."
  },
  {
    "objectID": "for_instructors/plan.html",
    "href": "for_instructors/plan.html",
    "title": "MF9130E - V23",
    "section": "",
    "text": "Self study sessions\nLab sessions"
  },
  {
    "objectID": "for_instructors/plan.html#monday-m",
    "href": "for_instructors/plan.html#monday-m",
    "title": "MF9130E - V23",
    "section": "Monday (M)",
    "text": "Monday (M)\n\nAfternoon: lecture: Intro, descriptive statistics (M)"
  },
  {
    "objectID": "for_instructors/plan.html#tuesday-ca",
    "href": "for_instructors/plan.html#tuesday-ca",
    "title": "MF9130E - V23",
    "section": "Tuesday (C,A)",
    "text": "Tuesday (C,A)\n\nMorning: R lab (C)\n9:00-10:00 Introduction to R\n10:15-11:00 Descriptive statistics\n11:00-12:00 Lab practice, plus discussion\n\n\nAfternoon: lecture: Probability, Diagnostic testing (A)\n13:00-13:15 Intro to probabilites and diagnostic testing\n13:15-14:30 Self study\n14:30-15:45 Paper and discussions in groups (COVID testing)\n15:45-16:00 Wrap up"
  },
  {
    "objectID": "for_instructors/plan.html#wednesday-av",
    "href": "for_instructors/plan.html#wednesday-av",
    "title": "MF9130E - V23",
    "section": "Wednesday (A,V)",
    "text": "Wednesday (A,V)\n\nMorning: R lab, lecture: distributions, simulation (A)\n9:00 - 9:15 Intro to probability distributions\n9:15 - 10:15 Self study\n10:15 - 11:45 R lab (Simulations)\n11:45 - 12:00 Wrap up\n\n\nAfternoon: lecture: confidence interval, t-test (V)\n13:00-13:30 lecture on confidence interval (intro)\n13:30-14:30 self study CI\n14:30-15:15 intro on testing - t test (one sample), simplest situation - t test (two sample)\n15:15-16:00 self study/home\n\n\nThursday (C,V)\n\nMorning: R lab (C)\n9:00-9:45 Lab\n\nrepeat theory\nR example\n\n9:45 - 11:00 Lab\n11:00-11:30 Lab (discussion)\n\n\nAfternoon: lecture: proportions, tables, chi-sq (V)\n12:30-13:30 lecture\n\nproportions (CI)\ntables\nrisks\n\n13:30-14:30 self study\n14:30-15:15 V intro to chi-sq test"
  },
  {
    "objectID": "for_instructors/plan.html#monday-cv",
    "href": "for_instructors/plan.html#monday-cv",
    "title": "MF9130E - V23",
    "section": "Monday (C,V)",
    "text": "Monday (C,V)\n\nMorning: lecture + lab: transformations, EDA, non-parametric tests (C)\n\n\nAfternoon: lecture + lab: sample size (V)"
  },
  {
    "objectID": "for_instructors/plan.html#tuesday-jo-m",
    "href": "for_instructors/plan.html#tuesday-jo-m",
    "title": "MF9130E - V23",
    "section": "Tuesday (Jo? M)",
    "text": "Tuesday (Jo? M)\nMorning: Study design (Jo?)\nAfternoon: regression (M)"
  },
  {
    "objectID": "for_instructors/plan.html#wednesday-mc",
    "href": "for_instructors/plan.html#wednesday-mc",
    "title": "MF9130E - V23",
    "section": "Wednesday (M,C?)",
    "text": "Wednesday (M,C?)\nMorning: regression\nAfternoon: regression"
  },
  {
    "objectID": "for_instructors/plan.html#thursday-m",
    "href": "for_instructors/plan.html#thursday-m",
    "title": "MF9130E - V23",
    "section": "Thursday (M)",
    "text": "Thursday (M)"
  },
  {
    "objectID": "lab/ex_eda_part1.html",
    "href": "lab/ex_eda_part1.html",
    "title": "Exercise - EDA (part I)",
    "section": "",
    "text": "Generate a variable named weight, with the following measurements:\n50 75 70 74 95 83 65 94 66 65 65 75 84 55 73 68 72 67 53 65\n\n\n\nMake a simple descriptive analysis of the variable, what are the mean, standard deviation, maximum, minimum and quantiles?\nHow to interpret the data?\n\n\n\nMake a histogram.\n\n\n\nMake a boxplot. What do the two dots on the top represent?"
  },
  {
    "objectID": "lab/ex_eda_part1.html#exercise-2-lung-function",
    "href": "lab/ex_eda_part1.html#exercise-2-lung-function",
    "title": "Exercise - EDA (part I)",
    "section": "Exercise 2 (lung function)",
    "text": "Exercise 2 (lung function)\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n2a)\nDownload and open PEFH98-english.dta into R.\nIf you have problem with .dta data format, you can also use PEFH98-english.csv.\nPay attention to how gender is coded. We might have to modify it.\n\n\n2b)\nHow many observations are there (number of subjects)? How do you get a list of variable names from your dataset?\nMake a histogram for each of the following variables. Compute means, and interpret the results.\nheight\nweight\nage\npefsitm\npefstam\n\n\n2c)\nMake histograms for the variables height and pefmean for men and women separately. Also try to make boxplots.\nWhat conclusion can you draw?\n\n\n2d)\nMake three scatterplots to compare\n\npefmean with height\npefmean with weight\npefmean with age\n\nWhat association do you see?"
  },
  {
    "objectID": "lab/lab_eda_part1.html#exercise-1-weight",
    "href": "lab/lab_eda_part1.html#exercise-1-weight",
    "title": "Exploratory data analysis (Part I)",
    "section": "Exercise 1 (weight)",
    "text": "Exercise 1 (weight)\n\n1a\nGenerate a variable named weight, with the following measurements:\n50 75 70 74 95 83 65 94 66 65 65 75 84 55 73 68 72 67 53 65\n\nweight <- c(50, 75, 70, 74, 95, \n            83, 65, 94, 66, 65, \n            65, 75, 84, 55, 73, \n            68, 72, 67, 53, 65)\n\n\n\n1b\nMake a simple descriptive analysis of the variable, what are the mean, median, maximum, minimum and quantiles?\nHow to interpret the data?\n\nmean(weight)\n\n[1] 70.7\n\nmedian(weight)\n\n[1] 69\n\nmax(weight)\n\n[1] 95\n\nmin(weight)\n\n[1] 50\n\n# alternatively, \nsummary(weight)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   50.0    65.0    69.0    70.7    75.0    95.0 \n\n\n\n\n1c\nMake a histogram.\n\nhist(weight)\n\n\n\n\n\n\n1d\nMake a boxplot. What do the two dots on the top represent?\n\nboxplot(weight)"
  },
  {
    "objectID": "lab/lab_eda_part1.html#exercise-2-lung-function",
    "href": "lab/lab_eda_part1.html#exercise-2-lung-function",
    "title": "Exploratory data analysis (Part I)",
    "section": "Exercise 2 (lung function)",
    "text": "Exercise 2 (lung function)\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n2a)\nDownload and open PEFH98-english.dta into R.\nIf you have problem with .dta data format, you can also use PEFH98-english.csv.\nPay attention to how gender is coded. We might have to modify it.\n\n# locate your datafile, set the path to your data\nlung_data <- haven::read_dta('data/PEFH98-english.dta')\nhead(lung_data)\n\n# A tibble: 6 × 13\n    age gender     height weight pefsit1 pefsit2 pefsit3 pefsta1 pefsta2 pefsta3\n  <dbl> <dbl+lbl>   <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1    20 1 [female]    165     50     400     400     410     410     410     400\n2    20 2 [male]      185     75     480     460     510     520     500     480\n3    21 2 [male]      178     70     490     540     560     470     500     470\n4    21 2 [male]      179     74     520     530     540     480     510     500\n5    20 2 [male]      196     95     740     750     750     700     710     700\n6    20 2 [male]      189     83     600     575     600     600     600     640\n# ℹ 3 more variables: pefsitm <dbl>, pefstam <dbl>, pefmean <dbl>\n\n# gender is coded as 1 and 2, but it looks like it's not a category but a 'double' (number)\n# we code it explicitly fo readability\nlung_data$gender <- factor(lung_data$gender, \n                           levels = c('1','2'),\n                           labels = c('female','male')) \nhead(lung_data)\n\n# A tibble: 6 × 13\n    age gender height weight pefsit1 pefsit2 pefsit3 pefsta1 pefsta2 pefsta3\n  <dbl> <fct>   <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1    20 female    165     50     400     400     410     410     410     400\n2    20 male      185     75     480     460     510     520     500     480\n3    21 male      178     70     490     540     560     470     500     470\n4    21 male      179     74     520     530     540     480     510     500\n5    20 male      196     95     740     750     750     700     710     700\n6    20 male      189     83     600     575     600     600     600     640\n# ℹ 3 more variables: pefsitm <dbl>, pefstam <dbl>, pefmean <dbl>\n\n\n\n\n2b)\nHow many observations are there (number of subjects)? How do you get a list of variable names from your dataset?\n\nnrow(lung_data)\n\n[1] 106\n\ncolnames(lung_data)\n\n [1] \"age\"     \"gender\"  \"height\"  \"weight\"  \"pefsit1\" \"pefsit2\" \"pefsit3\"\n [8] \"pefsta1\" \"pefsta2\" \"pefsta3\" \"pefsitm\" \"pefstam\" \"pefmean\"\n\n\nMake a histogram for each of the following variables. Compute means, and interpret the results.\nheight\nweight\nage\npefsitm\npefstam\n\nhist(lung_data$height)\n\n\n\n\nWe repeat it for the other 4 variables. We can put them more compactly,\n\npar(mfrow = c(2, 2)) \n# we use this line to display (2 rows 2 columns)\n# by default it is 1 row 1 column\n# run this line to set it back to default:\n# par(mfrow = c(1, 1))\nhist(lung_data$weight)\nhist(lung_data$age)\nhist(lung_data$pefsitm)\nhist(lung_data$pefstam)\n\n\n\n\n\n\n2c)\nMake histograms for the variables height and pefmean for men and women separately. Also try to make boxplots.\nWhat conclusion can you draw?\n\nheight_f <- lung_data$height[lung_data$gender == 'female']\nheight_m <- lung_data$height[lung_data$gender == 'male']\n\npar(mfrow = c(1,2)) # plot in parallel\nhist(height_f)\nhist(height_m)\n\n\n\n# we can make it more customized\n# add axis limit, title and xaxis name\npar(mfrow = c(1,2)) # plot in parallel\nhist(height_f, main = 'Height: female', xlab = 'Height (cm)',\n     xlim = c(150, 200))\nhist(height_m, main = 'Height: male', xlab = 'Height (cm)',\n     xlim = c(150, 200))\n\n\n\n\nSimilarly, histogram for pefmean can be done in the same way.\n\npefmean_f <- lung_data$pefmean[lung_data$gender == 'female']\npefmean_m <- lung_data$pefmean[lung_data$gender == 'male']\n\npar(mfrow = c(1,2)) # plot in parallel\nhist(pefmean_f)\nhist(pefmean_m)\n\n\n\n\nNow we can make some boxplots\n\npar(mfrow = c(1, 2))\nboxplot(height ~ gender, data = lung_data, main = 'Height vs Gender')\n\n# it is also possible to remove the frame\nboxplot(pefmean ~ gender, data = lung_data, frame = F, main = 'PEFmean vs gender')\n\n\n\n\n\n\n2d)\nMake three scatterplots to compare\n\npefmean with height\npefmean with weight\npefmean with age\n\nWhat association do you see?\n\n# pefmean height\nplot(lung_data$pefmean, lung_data$height)\n\n\n\n# it is possible to customize \nplot(lung_data$pefmean, lung_data$height, \n     main = 'PEF mean vs height', \n     xlab = 'PEF mean', ylab = 'Height',\n     pch = 20)\n\n\n\n# pch: plotting symbols\n\npch = 20 is setting the symbol to small solid dots. You can try different values, from 0 to 25. Read more\n\npar(mfrow = c(1, 2))\n# pefmean weight\nplot(lung_data$pefmean, lung_data$weight, \n     main = 'PEF mean vs weight', \n     xlab = 'PEF mean', ylab = 'Weight',\n     pch = 20)\n\n# pefmean age\nplot(lung_data$pefmean, lung_data$age, \n     main = 'PEF mean vs age', \n     xlab = 'PEF mean', ylab = 'Age',\n     pch = 20)"
  },
  {
    "objectID": "lab/lab_eda_part1.html#data-structure-use-penguins_mini-data-as-example",
    "href": "lab/lab_eda_part1.html#data-structure-use-penguins_mini-data-as-example",
    "title": "Exploratory data analysis (Part I)",
    "section": "Data structure (use penguins_mini data as example)",
    "text": "Data structure (use penguins_mini data as example)\nBec student background, it is not necessary to go into too much details\nMUST: concept of scalar, vector, matrix and data frame (dataset exploration put to descriptive and eda)\nMUST: numeric, factor, character, logical"
  },
  {
    "objectID": "lab/lab_eda_part1.html#exploring-a-dataset",
    "href": "lab/lab_eda_part1.html#exploring-a-dataset",
    "title": "Exploratory data analysis (Part I)",
    "section": "Exploring a dataset",
    "text": "Exploring a dataset\nhead()\nView()\nstr()\ncolnames()\ndim()\nnrow(), ncol()\nlength() of a vector"
  },
  {
    "objectID": "lab/lab_eda_part1.html#basic-data-manipulation",
    "href": "lab/lab_eda_part1.html#basic-data-manipulation",
    "title": "Exploratory data analysis (Part I)",
    "section": "Basic data manipulation",
    "text": "Basic data manipulation\nonly cover base R here; if needed, tidyverse put to eda\nby index, [row, col]"
  },
  {
    "objectID": "lab/lab_eda_part1.html#descriptive-statistics",
    "href": "lab/lab_eda_part1.html#descriptive-statistics",
    "title": "Exploratory data analysis (Part I)",
    "section": "Descriptive statistics",
    "text": "Descriptive statistics\nmin, max, median\nIQR\nsummary table () of a categorical vector"
  },
  {
    "objectID": "lab/lab_eda_part1.html#visualisation-only-intro-details-later",
    "href": "lab/lab_eda_part1.html#visualisation-only-intro-details-later",
    "title": "Exploratory data analysis (Part I)",
    "section": "Visualisation (only intro, details later)",
    "text": "Visualisation (only intro, details later)\nfocus on baseR solutions"
  },
  {
    "objectID": "lab/ex_ttest.html#exercise-2-lung-function",
    "href": "lab/ex_ttest.html#exercise-2-lung-function",
    "title": "Exercise - t-test",
    "section": "Exercise 2 (lung function)",
    "text": "Exercise 2 (lung function)\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n\n\n\n\n\nLung function data\n\n\n\nThis is the same dataset we have used in EDA (part I) from two days ago. You can use either PEFH98-english.dta, or PEFH98-english.csv data.\nIf you forgot how to load the data, you can refresh your knowledge by reading these notes (Example 2)\n\n\n\n2a)\nOpen PEFH98-english.dta (or PEFH98-english.csv) into R.\nPay attention to how gender is coded. We might have to modify it.\nDetermine the mean height for females. Calculate the standard deviation and a 95% confidence interval. How would you comment on this result?\nDo the same for males.\n\n\n2b)\nAssume that the average height for female students a few years ago was 167 cm. Does the height in the present material differ significantly?\nFormulate a null hypothesis, calculate a test statistic and p-value.\n\n\n2c)\nDo the values pefsit1 and pefsit2 differ significantly? Calculate a test statistic, the mean difference, and the 95% confidence interval, and formulate a conclusion. Interpret the results.\n\n\n2d)\nCarry out a t-test to decide whether pefsitm annd pefstam are significantly different.\n\n\n2e)\nAre the assumptions of the previous test reasonably fulfilled?\nYou should check that the difference between pefsitm and pefstam is normally distributed.\n\n\n\n\n\n\nExpand to read hint\n\n\n\n\n\nYou can create a new variable called difference by difference <- pefsitm - pefstam, then check the normality of difference by looking at histogram (hist(difference)), or QQ plot (qnorm difference)\n\n\n\n\n\n2f)\nCarry out a t-test to evaluate whether pefmean is signinficantly different for men and women.\nInterpret the results, and formulate a conclusion including p-value and confidence interval.\n\n\n2g)\nAre the assumptions fulfilled in the previous test (pefmean vs gender)?"
  },
  {
    "objectID": "lab/ex_categorical.html",
    "href": "lab/ex_categorical.html",
    "title": "Exercise - Categorical data analysis",
    "section": "",
    "text": "Datasets for exercises\n\n\n\nFor exercise I, it is the same dataset we have used in EDA (part I) from two days ago. You can use either PEFH98-english.dta, or PEFH98-english.csv data.\nFor exercise II, we use a dataset called birth.dta (or birth.csv).\nIf you forgot how to load the data, you can refresh your knowledge by reading these notes (Example 2)"
  },
  {
    "objectID": "lab/ex_categorical.html#exercise-2-lung-function",
    "href": "lab/ex_categorical.html#exercise-2-lung-function",
    "title": "Exercise - Table analysis",
    "section": "Exercise 2 (lung function)",
    "text": "Exercise 2 (lung function)\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n2a)\nDownload and open PEFH98-english.dta into R.\nIf you have problem with .dta data format, you can also use PEFH98-english.csv.\nPay attention to how gender is coded. We might have to modify it.\n\n\n2b)\nHow many observations are there (number of subjects)? How do you get a list of variable names from your dataset?\nMake a histogram for each of the following variables. Compute means, and interpret the results.\nheight\nweight\nage\npefsitm\npefstam\n\n\n2c)\nMake histograms for the variables height and pefmean for men and women separately. Also try to make boxplots.\nWhat conclusion can you draw?\n\n\n2d)\nMake three scatterplots to compare\n\npefmean with height\npefmean with weight\npefmean with age\n\nWhat association do you see?"
  },
  {
    "objectID": "lab/lab_ttest.html",
    "href": "lab/lab_ttest.html",
    "title": "t-test",
    "section": "",
    "text": "The weight of the hearts of 20 men with age between 25 and 55 years have been evaluated, and is given below (in ounces, 1 ounce = 28g)\n11.50 14.75 13.75 10.50 14.75 13.50 10.75 9.50 11.75 12.00\n10.50 11.75 10.00 14.50 12.00 11.00 14.00 15.00 11.50 10.25\n\n\nCreate a variable in R, and enter the data. Compute the mean weight of the hearts based on the formula; then verify it with R function.\n\n\n\n\n\n\nFormula: mean\n\n\n\nThe mean of data \\(X = (x_1, x_2, ... x_n)\\), \\(\\bar{x} = \\frac{1}{n}\\sum_{i = 1}^N x_i\\)\n\n\n\n# enter the data\nheart <- c(11.5, 14.75, 13.75, 10.5, 14.75,\n           13.5, 10.75, 9.5, 11.75, 12, \n           10.5, 11.75, 10, 14.5, 12, \n           11, 14, 15, 11.5, 10.25)\n\n\n# compute the mean\nsum_heart <- 11.5 + 14.75 + 13.75 + 10.5 + 14.75 + \n  13.5 + 10.75 + 9.5 + 11.75 + 12 + \n  10.5 + 11.75 + 10 + 14.5 + 12 + \n  11 + 14 + 15 + 11.5 + 10.25\n\nn <- 20 # length(heart)\n\nsum_heart\n\n[1] 243.25\n\nsum_heart/20\n\n[1] 12.1625\n\n# formula: sum(heart)/length(heart)\nmean(heart)  # 12.162\n\n[1] 12.1625\n\n\n\n\n\nCompute the 95% confidence interval for the mean. Verify your computed confidence interval with R function t.test(heart).\n\n\n\n\n\n\nFormula: confidence interval for the mean\n\n\n\n\n\n\n\n# standard deviation, 95% confidence interval\n\n# formula (sd): sqrt(1/(n-1) * (sum(xi - xbar)^2))\n# translate into format that R can understand:\n\nn <- 20  # length(heart)\nsqrt(1/(n-1) * (sum((heart - mean(heart))^2))) # be careful with brackets\n\n[1] 1.779405\n\nsd(heart) # 1.779\n\n[1] 1.779405\n\n# 95% CI (quantile from t-distribution)\n# formula: CI = xbar +- t(n-1, alpha/2) * sd/sqrt(n)\n# translate into format R can understand:\n\nt025 <- qt(p = 0.025, df = n-1) # -2.09\nt975 <- qt(p = 0.975, df = n-1) # 2.09\nc(t025, t975) # symmetric around 0\n\n[1] -2.093024  2.093024\n\n# plug in the formula\nci_lower <- mean(heart) - t975 * sd(heart)/sqrt(n)\nci_upper <- mean(heart) + t975 * sd(heart)/sqrt(n)\nc(ci_lower, ci_upper)\n\n[1] 11.32971 12.99529\n\n# verify by doing a one-sample t-test\n# by default, it tests whether mean is 0\nt.test(heart)\n\n\n    One Sample t-test\n\ndata:  heart\nt = 30.568, df = 19, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 11.32971 12.99529\nsample estimates:\nmean of x \n  12.1625 \n\n\n\n\n\nWe would like to know whether the mean heart weight is equal to 11 and 11.5.\nBefore you carry out hypothesis tests, you can gain useful insight by visualization. You can try to use histogram, Q-Q plot and boxplot, and compare the mean heart weight with 11 and 11.5.\nWhat can you conclude?\n\npar(mfrow = c(1, 2))\n# histogram\nhist(heart, breaks = 10, main = 'Histogram of heart data')\nabline(v = mean(heart), col = 'red', lwd = 2)\nabline(v = c(ci_lower, ci_upper), col = 'red', lwd = 2,\n       lty = 'dashed')\n\n# qqplot \nqqnorm(heart, pch = 20)\nqqline(heart, lwd = 2)\n\n\n\n\n\n# boxplot \npar(mfrow = c(1, 2))\n# compare with 11\nboxplot(heart, horizontal = T, main = 'Compare with mean = 11')\nabline(v = mean(heart), col = 'red', lwd = 3)\nabline(v = c(ci_lower, ci_upper), col = 'red', lwd = 2,\n       lty = 'dashed')\nabline(v = 11, col = 'forestgreen', lwd = 3)\n\n\n# compare with 11.5\nboxplot(heart, horizontal = T, main = 'Compare with mean = 11.5')\nabline(v = mean(heart), col = 'red', lwd = 3)\nabline(v = c(ci_lower, ci_upper), col = 'red', lwd = 2,\n       lty = 'dashed')\nabline(v = 11.5, col = 'forestgreen', lwd = 3)\n\n\n\n\n\n\n\nFormulate hypothesis tests. Decide whether you need one-sided or two-sided test, and state your conclusion (with p-values and confidence intervals).\n\n# H0: mu = 11; H1: mu != 11\nt.test(heart, mu = 11, conf.level = 0.95)\n\n\n    One Sample t-test\n\ndata:  heart\nt = 2.9217, df = 19, p-value = 0.008751\nalternative hypothesis: true mean is not equal to 11\n95 percent confidence interval:\n 11.32971 12.99529\nsample estimates:\nmean of x \n  12.1625 \n\n# H0: mu = 11.5; H1: mu != 11.5\nt.test(heart, mu = 11.5, conf.level = 0.95)\n\n\n    One Sample t-test\n\ndata:  heart\nt = 1.665, df = 19, p-value = 0.1123\nalternative hypothesis: true mean is not equal to 11.5\n95 percent confidence interval:\n 11.32971 12.99529\nsample estimates:\nmean of x \n  12.1625 \n\n\n\n\n\n\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n\n\n\n\n\nLung function data\n\n\n\nThis is the same dataset we have used in EDA (part I) from two days ago. You can use either PEFH98-english.dta, or PEFH98-english.csv data.\nIf you forgot how to load the data, you can refresh your knowledge by reading these notes (Example 2)\n\n\n\n\nOpen PEFH98-english.dta (or PEFH98-english.csv) into R.\nPay attention to how gender is coded. We might have to modify it.\nDetermine the mean height for females. Calculate the standard deviation and a 95% confidence interval. How would you comment on this result?\nDo the same for males.\n\nlung_data <- haven::read_dta('data/PEFH98-english.dta')\n\n# recode gender: female, male\nlung_data$gender <- factor(lung_data$gender, \n                           levels = c('1','2'),\n                           labels = c('female','male')) \n# head(lung_data)\n# we can focus on height and gender variable only\nhead(lung_data[, c('height', 'gender')], 10)\n\n# A tibble: 10 × 2\n   height gender\n    <dbl> <fct> \n 1    165 female\n 2    185 male  \n 3    178 male  \n 4    179 male  \n 5    196 male  \n 6    189 male  \n 7    173 male  \n 8    196 male  \n 9    173 female\n10    173 female\n\n\nNow we need to separate the height data for based on gender. First, we do it for gender == 'female'.\n\n# for convenience, we create a variable names 'gender'\ngender <- lung_data$gender\n# height for female\nheight_f <- lung_data$height[gender == 'female']\n\nYou should always check whether your newly created variable is correct: for example, you can compare the first several values of height_f with the original data, to see if it is really only selecting height for females.\nAnother useful thing to do is to check how many data poinnts have been selected.\n\n# check the first few values, is it only selecting female heights?\nhead(height_f)\n\n[1] 165 173 173 169 170 172\n\n# number of females\nnf <- length(height_f)  # 54\nnf\n\n[1] 54\n\n\nNow we can compute the mean and confidence interval on the newly created variable, height_f.\n\nmean(height_f) # 169.57\n\n[1] 169.5741\n\nsd(height_f) # 5.69\n\n[1] 5.692106\n\n# se_f <- sd(height_f)/sqrt(54) 0.774\n\n# quantile for t distribution: pay attention to df!\nt975 <- qt(p = 0.975, df = nf-1) # 2.005\n\n# 95% CI \nci_upper_f <- mean(height_f) + t975 * sd(height_f)/sqrt(nf) # 171.1277\nci_lower_f <- mean(height_f) - t975 * sd(height_f)/sqrt(nf) # 168.0204\nc(ci_lower_f, ci_upper_f)\n\n[1] 168.0204 171.1277\n\n# double check by running a t.test\nt.test(height_f)\n\n\n    One Sample t-test\n\ndata:  height_f\nt = 218.92, df = 53, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 168.0204 171.1277\nsample estimates:\nmean of x \n 169.5741 \n\n\nFor gender == 'male', we can do the same thing. Pay attention to the different degrees of freedom, because the sample size has changed.\n\n# height for male \nheight_m <- lung_data$height[gender == 'male']\n# number of males\nnm <- length(height_m)  # 52\n\nmean(height_m) # 181.87\n\n[1] 181.8654\n\nsd(height_m) # 5.67\n\n[1] 5.667343\n\n# se_m <- sd(height_m)/sqrt(52) # 0.786\n\n# find quantile for males (pay attention to df)\nt975 <- qt(p = 0.975, df = nm-1) # 2.007\n# 95% CI\nci_upper_m <- mean(height_m) + t975 * sd(height_m)/sqrt(nm) # 183.44\nci_lower_m <- mean(height_m) - t975 * sd(height_m)/sqrt(nm)  # 180.28\nc(ci_lower_m, ci_upper_m)\n\n[1] 180.2876 183.4432\n\n# verify by t.test\nt.test(height_m)\n\n\n    One Sample t-test\n\ndata:  height_m\nt = 231.4, df = 51, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 180.2876 183.4432\nsample estimates:\nmean of x \n 181.8654 \n\n\n\n\n\nAssume that the average height for female students a few years ago was 167 cm. Does the height in the present material differ significantly?\nFormulate a null hypothesis, calculate a test statistic and p-value.\n\n# use t.test command\nt.test(height_f, mu = 167)\n\n\n    One Sample t-test\n\ndata:  height_f\nt = 3.3231, df = 53, p-value = 0.001619\nalternative hypothesis: true mean is not equal to 167\n95 percent confidence interval:\n 168.0204 171.1277\nsample estimates:\nmean of x \n 169.5741 \n\n# alternatively, \n# calculate by hand\nt_stat <- (mean(height_f) - 167)/(sd(height_f)/sqrt(nf))\nt_stat  # 3.323\n\n[1] 3.323112\n\n# compare this with t distribution with nf-1 degrees of freedom\npval_twosided <- pt(q = t_stat, df = nf-1, lower.tail = F)*2\npval_twosided\n\n[1] 0.001618751\n\n\n\n\n\nDo the values pefsit1 and pefsit2 differ significantly? Calculate a test statistic, the mean difference, and the 95% confidence interval, and formulate a conclusion. Interpret the results.\n\npefsit1 <- lung_data$pefsit1\npefsit2 <- lung_data$pefsit2\n# hist(pefsit1)\n# hist(pefsit2)\n\nt.test(pefsit1, pefsit2, paired = T)\n\n\n    Paired t-test\n\ndata:  pefsit1 and pefsit2\nt = -1.5781, df = 104, p-value = 0.1176\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -9.929056  1.129056\nsample estimates:\nmean difference \n           -4.4 \n\n# alternatively, you can test whether the difference is equal to 0\ndiff_sit1_sit2 <- pefsit1 - pefsit2\nt.test(diff_sit1_sit2, mu = 0)\n\n\n    One Sample t-test\n\ndata:  diff_sit1_sit2\nt = -1.5781, df = 104, p-value = 0.1176\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n -9.929056  1.129056\nsample estimates:\nmean of x \n     -4.4 \n\n\n\n\n\nCarry out a t-test to decide whether pefsitm annd pefstam are significantly different.\n\n# compare pefsitm, pefstam (paired t-test)\npefsitm <- lung_data$pefsitm\npefstam <- lung_data$pefstam\n\nt.test(pefsitm, pefstam, paired = T)\n\n\n    Paired t-test\n\ndata:  pefsitm and pefstam\nt = -3.6974, df = 104, p-value = 0.0003498\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -14.656161  -4.423204\nsample estimates:\nmean difference \n      -9.539683 \n\n\n\n\n\nAre the assumptions of the previous test reasonably fulfilled?\nYou should check that the difference between pefsitm and pefstam is normally distributed.\n\n\n\n\n\n\nExpand to read hint\n\n\n\n\n\nYou can create a new variable called difference by difference <- pefsitm - pefstam, then check the normality of difference by looking at histogram (hist(difference)), or QQ plot (qnorm difference)\n\n\n\n\n# create a variable\ndiff_sitm_stam <- pefsitm - pefstam\nqqnorm(diff_sitm_stam, pch = 20)\nqqline(diff_sitm_stam, col = 'red', lwd = 2)\n\n\n\n\n\n\n\nCarry out a t-test to evaluate whether pefmean is signinficantly different for men and women.\nInterpret the results, and formulate a conclusion including p-value and confidence interval.\n\n# this is independent two samples t-test\n# we need two variables: pefmean for men, pefmean for women\n\npefmean_f <- lung_data$pefmean[gender == 'female']\npefmean_m <- lung_data$pefmean[gender == 'male']\n\n\n# visually spot whether there is a difference\n# NOTE: there is a NA in pefmean_f\npar(mfrow = c(1, 2))\nhist(pefmean_f, main = 'pefmean (F)')\nabline(v = mean(pefmean_f, na.rm = T), col = 'red', lwd = 2)\nhist(pefmean_m, main = 'pefmean (M)')\nabline(v = mean(pefmean_m), col = 'red', lwd = 2)\n\n\n\n# two sample t-test \nt.test(pefmean_f, pefmean_m, paired = F)\n\n\n    Welch Two Sample t-test\n\ndata:  pefmean_f and pefmean_m\nt = -12.425, df = 90.28, p-value < 2.2e-16\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -207.6366 -150.3941\nsample estimates:\nmean of x mean of y \n 425.2987  604.3141 \n\n\n\n\n\nAre the assumptions fulfilled in the previous test (pefmean vs gender)?\n\npar(mfrow = c(1, 2))\nqqnorm(pefmean_f, pch = 20, main = 'Q-Q plot: pefmean (F)')\nqqline(pefmean_f, col = 'red', lwd = 2)\n\nqqnorm(pefmean_m, pch = 20, main = 'Q-Q plot: pefmean (M)')\nqqline(pefmean_m, col = 'red', lwd = 2)"
  },
  {
    "objectID": "lab/ex_ttest.html",
    "href": "lab/ex_ttest.html",
    "title": "Exercise - t-test",
    "section": "",
    "text": "The weight of the hearts of 20 men with age between 25 and 55 years have been evaluated, and is given below (in ounces, 1 ounce = 28g)\n11.50 14.75 13.75 10.50 14.75 13.50 10.75 9.50 11.75 12.00\n10.50 11.75 10.00 14.50 12.00 11.00 14.00 15.00 11.50 10.25\n\n\nCreate a variable in R, and enter the data. Compute the mean weight of the hearts based on the formula; then verify it with R function.\n\n\n\n\n\n\nFormula: mean\n\n\n\nThe mean of data \\(X = (x_1, x_2, ... x_n)\\), \\(\\bar{x} = \\frac{1}{n}\\sum_{i = 1}^N x_i\\)\n\n\n\n\n\nCompute the 95% confidence interval for the mean. Verify your computed confidence interval with R function t.test(heart).\n\n\n\n\n\n\nFormula: confidence interval for the mean\n\n\n\n\n\n\n\n\n\nWe would like to know whether the mean heart weight is equal to 11 and 11.5.\nBefore you carry out hypothesis tests, you can gain useful insight by visualization. You can try to use histogram, Q-Q plot and boxplot, and compare the mean heart weight with 11 and 11.5.\nWhat can you conclude?\n\n\n\nFormulate hypothesis tests. Decide whether you need one-sided or two-sided test, and state your conclusion (with p-values and confidence intervals)."
  },
  {
    "objectID": "lab/ex_categorical.html#exercise-2-birth-data",
    "href": "lab/ex_categorical.html#exercise-2-birth-data",
    "title": "Exercise - Categorical data analysis",
    "section": "Exercise 2 (birth data)",
    "text": "Exercise 2 (birth data)\nWe shall analyse the data set given in the file birth.dta. In a study in Massachusetts, USA, birth weight was measured for the children of 189 women. The main variable in the study was birth weight, BWT, which is an important indicator of the condition of a newborn child. Low birth weight (below 2500 g) may be a medical risk factor. A major question is whether smoking during pregnancy influences the birth weight. One has also studied whether a number of other factors are related to birth weight, such as hypertension in the mother.\nThe variables of the study are\n\nIdentification number (ID)\nLow birth weight, 1 means \\(BWT \\leq 2500g\\), 0 means \\(BWT > 2500g\\) (LOW)\nAge of the mother (AGE)\nWeight (in pounds) at last menstruaal period (LWT)\nEthnicity, 1 means White, 2 means African American, 3 meaans other (ETH)\nSmoking status, 1 means current smoker, 0 means not smoking during pregnancy (SMK)\nHistory of premature labbour, values 0, 1, 2… (PTL)\nHistory of hypertension, 1 is yes, 0 is no (HT)\nUterine irritability, 1 is yes, 0 is no (UI)\nFirst trimester visits, values 0, 1, 2… (FTV)\nThird trimster visits, values 0, 1, 2… (TTV)\nBirth weight (BWT)\n\n\n2a)\nDoes smoking influence the birth weight of a baby?\nMake a histogram and a box plot, and find the median and mean for birth weight in grams (BWT) for the two groups of mothers: group 1 that smokes, and group 2 that does not smoke durinng the pregnancy. (Hint: use variable SMK for this task)\n\n\n2b)\nAre the distributions for the two groups normal? Can we conclude that smoking has an effect on the weight of a newborn? Use a t-test.\n\n\n2c)\nDo mothers of hypertension have a tendency to have babies with a lower birth weight? (The variable for hypertension is HT)\nMake a histogram of birth weight for the two groups of mothers with and without hypertension. What do you observe?"
  },
  {
    "objectID": "lab/lab_intro_rstudio.html",
    "href": "lab/lab_intro_rstudio.html",
    "title": "Getting started in RStudio",
    "section": "",
    "text": "Create a new project\nYou can use Rstudio without a project. However, it can help you navigating the workspace by\n\ncreating a folder\ncollecting your scripts and documentation\n\nAs a result, you can find things more easily, and do not need to set a path every time you open R.\nClick the button on the top left, it allows you to craete project. We choose New Directory.\n\n\nYou need to give this project a name. We can call it mf9130 for now.\nRStudio will also ask you where to put this project; you can put it somewhere easy to find.\n\nNow you will see a new Rstudio session has been opened. At this point, you should be able to see the bottom right panel with a blue icon, with your specified project name.\n\n\n\nNavigate your project\nThe benefit of creating a project is that all your work (code, documentation, possibly datasets) is put in one place.\n\n\n\n\n\n\nWhere to put your data\n\n\n\nTo keep things organized, people typically do one of the two things when it comes to data:\n\nstore the data in the same folder as other related code and analysis (this is what we are showing now);\nstore all the data from different studies together somewhere else, inside a data folder.\n\nBoth are good practices, as long as you stay organized.\n\n\n\nExample: import data in Rstudio\nAssume that you have the following datasets:\n\npenguins_mini.csv in the same folder as your mf9130.Rproj\npenguins_mini_copy.csv in the data folder, inside your project folder\n\nwe would refer to it as data/penguins_mini_copy.csv\nif you use windows system, it could look like data\\penguins_mini_copy.csv.\n\n\nIn Rstudio project, you can see them presented in the same way that matches your folder.\n\n\nTo load data within the Rstudio project, you only need to call the relative path to the data: for example, penguins_mini.csv or data/penguins_mini_copy.csv\n\n\n\n\n\n\nRelative path\n\n\n\n\n\nIf your project called /Users/your/project/location/proj, and your data is located in /Users/your/project/location/data/data.csv, the relative path between the project and data is data/data.csv.\n\n\n\nTo load data outside the project, you need to specify the absolute path in your system (looks like the last line below). It can be a bit annoying to do it everytime, so it might be a good idea to create a project!"
  },
  {
    "objectID": "lab/lab_intro_rstudio.html#navigate-your-project",
    "href": "lab/lab_intro_rstudio.html#navigate-your-project",
    "title": "Getting started in RStudio",
    "section": "Navigate your project",
    "text": "Navigate your project\nThe benefit of creating a project is that all your work (code, documentation, possibly datasets) is put in one place.\n\n\n\n\n\n\nWhere to put your data\n\n\n\nTo keep things organized, people typically do one of the two things when it comes to data:\n\nstore the data in the same folder as other related code and analysis (this is what we are showing now);\nstore all the data from different studies together somewhere else, inside a data folder.\n\nBoth are good practices, as long as you stay organized."
  },
  {
    "objectID": "lab/list_of_commands.html",
    "href": "lab/list_of_commands.html",
    "title": "List of commands",
    "section": "",
    "text": "Hypothesis tests\n\nt-test\n\n\nchi-square tests\n\n\nnon-parametric tests\n\n\n\nRegression\n\nCorrelation\n\n\nLinear regression\n\n\nLogistic regression\n\n\nSurvival analysis"
  },
  {
    "objectID": "lab/lab_categorical.html",
    "href": "lab/lab_categorical.html",
    "title": "Categorical data analysis",
    "section": "",
    "text": "Lung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n\nWe investigate whether having a high value of pefmean is associated with gender. First, create a new variable highpef that indicates whether pefmean is above 500.\n\nlung_data <- haven::read_dta('data/PEFH98-english.dta')\n\n# recode gender: female, male\nlung_data$gender <- factor(lung_data$gender, \n                           levels = c('1','2'),\n                           labels = c('female','male')) \n# head(lung_data)\n\n# examine variable pefmean\n# visualise the distribution\nhist(lung_data$pefmean)\nabline(v = 500, col = 'red', lwd = 2)\n\n\n\n\nThere are multiple ways to do it. Here we show two of them.\nIn option 1, we use the function ifelse(). It will create a binary vector, and fill in different output based on whether the condition was true or not.\n\n# option 1\n# code new variable: highpef with cutoff = 500\n# this is a binary variable, 1 means yes (higher than 500), 0 means no\nhighpef <- ifelse(lung_data$pefmean > 500, '1', '0')\n\n# check if it makes sense\nhead(lung_data$pefmean)\n\n[1] 405.0000 491.6667 505.0000 513.3333 725.0000 602.5000\n\nhead(highpef)\n\n[1] \"0\" \"0\" \"1\" \"1\" \"1\" \"1\"\n\n\nIn option 2, we create a vector with a pre-specified value, then replace the elements for given indices.\n\n# option 2 \n# create a vector with all '0's\n# then set the elements above 500 in 'pefmean' as '1'\n# (replacement with index)\n\nn <- length(lung_data$pefmean) # 106\nhighpef_alt <- rep('0', n) # repeat '0' 106 times\nhighpef_alt[lung_data$pefmean > 500] <- '1'\nhead(highpef_alt)\n\n[1] \"0\" \"0\" \"1\" \"1\" \"1\" \"1\"\n\n\n\n\n\nWe investigate the association between these two variables via an appropriate table analysis. Make a table of highpef vs gender, and carry out a chi-square analysis. Interpret your results.\n\n# take out gender variable so we don't need to use $ any more\ngender <- lung_data$gender\n\n# we can count how many subjects are in each category for the two variables\n# put in two tables \ntable(gender)\n\ngender\nfemale   male \n    54     52 \n\ntable(highpef)\n\nhighpef\n 0  1 \n54 51 \n\n# now we count how many subjects are in the combinations \ntable_gender_highpef <- table(gender, highpef)\ntable_gender_highpef\n\n        highpef\ngender    0  1\n  female 48  5\n  male    6 46\n\n\nWe do a chi-square test with chisq.test() function. To read more about what is required as input, you can use ?chisq.test() to get the documentation.\n\n# note: \n# we have not distinguished between exposure and outcome\n# by default, 'table' function puts the first input in rows (gender)\n# the order does not affect the result of chi-square test\n\nchisq.test(table_gender_highpef)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table_gender_highpef\nX-squared = 62.498, df = 1, p-value = 2.667e-15\n\n\n\n\n\n\n\n\nChi-square test measures strength of association\n\n\n\nIt is worth pointing out that chisq.test() does not distinguish between exposure and outcome variables. If you reverse the variable order, the test-statistic and p-value is exactly the same.\nThis is why you should always be clear in your mind what is your exposure and outcome, and report risk ratio and/or odds ratio.\n\n\n\n# reverse the order of the two variables\ntable_highpef_gender <- table(highpef, gender)\nchisq.test(table_highpef_gender)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table_highpef_gender\nX-squared = 62.498, df = 1, p-value = 2.667e-15\n\n\n\n\n\nCompute risk ratio and odds ratio (only the point estimates). Here the exposure is gender (we assume that the reference group is female: unexposed), and outcome is highpef. Interpret your results.\n\n\n\n\n\n\nRisk ratio and odds ratio\n\n\n\n\n\n\n\n\n\nOutcome (yes)\nOutcome (no)\n\n\n\n\nExposed\na\nb\n\n\nUnexposed\nc\nd\n\n\n\nRisk ratio: \\(\\frac{a/(a+b)}{c/(c+d)}\\)\nOdds ratio: \\(\\frac{a/b}{c/d} = \\frac{ad}{bc}\\)\n\n\n\nIt could help by drawing a table before computing the metrics.\n\n\n\n\nOutcome (highpef = 1)\nOutcome (highpef = 0)\n\n\n\n\nExposed (gender = male)\n46\n6\n\n\nUnexposed (gender = female)\n5\n48\n\n\n\n\n# first use formula (only point estimates)\n# risk ratio (relative risk)\n# risk in exposed / risk in unexposed\n\nrisk_exposed <- 46/(46+6)  # 0.885\nrisk_unexposed <- 5/(5+48) # 0.094\nrr <- risk_exposed/risk_unexposed\nrr  # 9.37\n\n[1] 9.376923\n\n# odds ratio\n# odds of event in exposed group / odds of event in non-exposed group\nodds_exposed <- 46/6  # 7.667\nodds_unexposed <- 5/48  # 0.104\nor <- odds_exposed/odds_unexposed\nor # 73.6\n\n[1] 73.6\n\n\n\n\n\nYou can verify if this is correct with some R packages that implement risk ratio and odds ratio.\n\n\n\n\n\n\nBe careful with the input format when using packages\n\n\n\nDifferent packages can have different requirements for how your data input should look like. Always check documentation to get the correct result.\nThis is also true with other softwares like STATA.\nComparison of different packages in computing risk ratio: read this discussion\nDocumentation: epitools Documentation: epiR\n\n\nThe first function we use is epitab from epitools package.\n\n# install.packages('epitools')\n\n# match the expected data format\n# col: outcome -, outcome +\n# row: exposure -, exposure +\n#tb1 <- matrix(c(48, 5, 6, 46), byrow = T, ncol = 2)\n#tb1\n#epitools::epitab(tb1, method = 'riskratio')\n#epitools::epitab(tb1, method = 'oddsratio')\n\nThe second function we use is epi.2by2 from epiR package.\n\n# install.packages('epiR')\n\n# match the expected data format\n# col: outcome +, outcome -\n# row: exposure +, exposure -\ntb2 <- matrix(c(46, 6, 5, 48), byrow = T, ncol = 2)\ntb2\n\n     [,1] [,2]\n[1,]   46    6\n[2,]    5   48\n\nepiR::epi.2by2(tb2, method = 'cohort.count')\n\n             Outcome +    Outcome -      Total                 Inc risk *\nExposed +           46            6         52     88.46 (76.56 to 95.65)\nExposed -            5           48         53       9.43 (3.13 to 20.66)\nTotal               51           54        105     48.57 (38.70 to 58.53)\n\nPoint estimates and 95% CIs:\n-------------------------------------------------------------------\nInc risk ratio                                 9.38 (4.05, 21.72)\nOdds ratio                                     73.60 (21.01, 257.87)\nAttrib risk in the exposed *                   79.03 (67.31, 90.75)\nAttrib fraction in the exposed (%)            89.34 (75.30, 95.40)\nAttrib risk in the population *                39.14 (26.76, 51.52)\nAttrib fraction in the population (%)         80.58 (57.91, 91.04)\n-------------------------------------------------------------------\nUncorrected chi2 test that OR = 1: chi2(1) = 65.624 Pr>chi2 = <0.001\nFisher exact test that OR = 1: Pr>chi2 = <0.001\n Wald confidence limits\n CI: confidence interval\n * Outcomes per 100 population units"
  },
  {
    "objectID": "lab/ex_categorical.html#exercise-1-lung-function",
    "href": "lab/ex_categorical.html#exercise-1-lung-function",
    "title": "Exercise - Categorical data analysis",
    "section": "Exercise 1 (lung function)",
    "text": "Exercise 1 (lung function)\nLung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sitting position, and three times in a standing position.\nThe variables are\n\nAge (years)\nGender (1 is female, 2 is male)\nHeight (cm)\nWeight (kg)\nPEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)\nPEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)\nMean of the three measurements made in a sitting position (pefsitm)\nMean of the three measurements made in a standing position (pefstam)\nMean of all six PEF values (pefmean)\n\n\n1a)\nWe investigate whether having a high value of pefmean is associated with gender.\nFirst, create a new variable highpef that indicates whether pefmean is above 500.\n\n\n1b)\nWe investigate the association between these two variables via an appropriate table analysis. Make a table of highpef vs gender, and carry out a chi-square analysis. Interpret your results.\n\n\n1c)\nCompute risk ratio and odds ratio (only the point estimates). Here the exposure is gender (we assume that the reference group is female: unexposed), and outcome is highpef. Interpret your results.\n\n\n\n\n\n\nRisk ratio and odds ratio\n\n\n\n\n\n\n\n\n\nOutcome (yes)\nOutcome (no)\n\n\n\n\nExposed\na\nb\n\n\nUnexposed\nc\nd\n\n\n\nRisk ratio: \\(\\frac{a/(a+b)}{c/(c+d)}\\)\nOdds ratio: \\(\\frac{a/b}{c/d} = \\frac{ad}{bc}\\)"
  },
  {
    "objectID": "course_material/notes_probability.html",
    "href": "course_material/notes_probability.html",
    "title": "Probability",
    "section": "",
    "text": "Topics:\nBooks and resources:"
  },
  {
    "objectID": "course_material/notes_probability.html#basic-concepts",
    "href": "course_material/notes_probability.html#basic-concepts",
    "title": "Probability",
    "section": "Basic concepts",
    "text": "Basic concepts\nA probability expresses a potential for something to happen.\nIt is an assessment of uncertainty in a situation or event.\nIt corresponds to the concept of risk in medicine.\n\nBrief history\nBlaise Pascal (17th century) was the founder of probability theory, the set of basic rules for doing probability calculations. His work was motivated by dice and card games.\nAndrey Kolmogorov formulated the exact probability rules as late as 1933.\n\n\nTwo definitions of probability\nFrequentist definition: Proportions of times (or frequency) that some event occurs in a large number of similar repeated trials.\nBayesian definition: Degree of belief in the occurrence of an event.\n\n\n\n\n\n\nObservation\n\n\n\n\n\nIn this course we focus in the frequentist definition, the most widely used. However, we will see at the end of this section that the Bayesian definition is important as it constitutes the foundation of the Bayesian approach to statistics, after Thomas Bayes (18th century).\n\n\n\n\n\nLaw of Large Numbers\n“As an experiment is repeated over and over, the observed frequency approaches the true probability”.\n\n\n\n\n\n\nExample: Coin tossing\n\n\n\n\n\nThis figure shows the frequency of heads in up to 200 simulated coin tosses. We can see that the frequency approaches the value 0.5 as the number of tosses grows.\n\n\n\n\nThe frequentist view of probability interprets the frequency of an event in a large number of experiments as its probability.\n\n\n\n\n\n\nExample: Births in Norway\n\n\n\n\n\nGiving birth to a girl or a boy is perceived as a random event. This table contains the frequencies of occurrence of the event “giving birth to a girl” in Norway during 2019-2022\n\nSource: Statistisk sentralbyrå\n\n\n\n\n\n\n\n\n\nYear\nTotal number of births\nNumber of boys\nNumber of girls\nPercentage of girls\n\n\n\n\n2022\n51480\n26445\n25035\n48.6\n\n\n2021\n56060\n28684\n27376\n48.8\n\n\n2020\n52979\n27063\n25916\n48.9\n\n\n2019\n54495\n28042\n26453\n48.5\n\n\n\nThe probability of giving birth to a girl in Norway is approximately 0.49"
  },
  {
    "objectID": "course_material/notes_probability.html#probability-calculation",
    "href": "course_material/notes_probability.html#probability-calculation",
    "title": "Probability",
    "section": "Probability calculation",
    "text": "Probability calculation\n\nEvents and sample space, stochastic trial\nA stochastic trial is characterized by an uncertain outcome.\nAll possible outcomes in a stochastic trial make up the sample space.\nEach outcome has a probability of ocurrence between 0 and 1. A probability equal to 0 means that the event can never occur, and equal to 1 means that the event is certeinly occuring.\nThe sum of all probabilities in a sample space equals 1.\nAn event can be a single outcome, or a collection of single outcomes.\n\n\n\n\n\n\nExamples: Stochastic trials\n\n\n\n\n\nDice tossing\n\nSample space: {1,2,3,4,5,6}\nEvents:\n\nEven number of eyes: {2,4.6}\nMore than 3 eyes: {4,5,6}\n\n\nChild birth\n\nSample space: {B,G}\nEvents:\n\nHaving a girl: {G}\nNot having a girl: {B}\n\n\nDiastolic blood pressure\n\nSample space: {40,41,…,119,120}\nEvent:\n\nHypertension: {91,92, …, 120}\n\n\n\n\n\n\n\nVenn diagram\nVenn diagrams are often used to illustrate events, like the events A and B below within the sample space S.\n\n\n\n\n\n\n\n\n\n\n\n\nOperators on events:\n\nUnion: \\(A \\cup B\\)\nIntersection: \\(A \\cap B\\)\nComplement: \\(\\bar{A}\\)\n\n\n\n\n\n\n\n\n Union: \\(A \\cup B\\)\n Intersection: \\(A \\cap B\\)\n\n\n\n\n\n\n\n\n\n\n Complement: \\(\\bar{A}\\)\n Combining operators: \\(A \\cap \\bar{B}\\)\n\n\n\n\n\nProbability calculation rules\nThe probability of event \\(A\\) is denoted by \\(P(A)\\). It has a value between 0 and 1. The probability over the whole sample space equals 1.\nComplement rule\n\\[P(A) + P(\\bar{A}) = 1\\]\nAdditive rule\nThe occurrence of at least one of the events \\(A\\) or \\(B\\) is \\[P(A \\cup B) = P(A) + P(B) - P(A \\cap B)\\] For disjunct events \\(A\\) and \\(B\\), \\(P(A \\cap B) = 0\\). Hence \\[P(A \\cup B) = P(A) + P(B)\\]\nMultiplicative rule\nProbability of independent events can be multiplied\n\\[P(A \\cap B) = P(A) \\times P(B)\\]\n\n\n\n\n\n\nExample: Child gender in two births\n\n\n\n\n\nWhat is the probability of giving birth to at least one girl?\n\nWe assume the probability of giving birth to a girl is 0.5.\nWe assume that the two births are independent events.\n\n\\[\n\\begin{aligned}\nP(\\text{at least one girl}) & =P(\\text{1st child is girl}) + P(\\text{2nd child is girl})-P(\\text{both are girls}) \\\\\n& = 1/2 + 1/2 - 1/2 \\times 1/2 = 3/4\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExamples: Tossing two dices\n\n\n\n\n\nWhat is the probability of getting 6 in the first AND the second throw? What is the probability of getting at least one 6 in two throws? What is the probability of not getting any 6 in two throws?\n\nThe two throws are independent events.\nThere are 36 equally possible outcomes.\nOnly one outcome corresponds to the double 6 event.\n\\[P(\\text{6 in the first AND the second throw}) = 1/6 \\times 1/6 = 1/36\\]\n\\[\n\\begin{aligned}\nP(\\text{at least one 6 in 2 trows}) &=P(\\text{6 in the first}) + P(\\text{6 in the second}) - P(\\text{6 in both})\\\\\n&=1/6 +1/6 - 1/36 =0.31\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\nP(\\text{not getting any 6 in 2 trows}) &= 1 - P(\\text{at least one 6 in 2 trows})\\\\\n&= 1 - 0.31 = 0.69\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "course_material/notes_probability.html#conditional-probability",
    "href": "course_material/notes_probability.html#conditional-probability",
    "title": "Probability",
    "section": "Conditional probability",
    "text": "Conditional probability\nWhat is the probability of getting the outcome \\(A\\) given that the event \\(B\\) has occur? For example, what is the risk of becoming sick from COVID-19 given that your spouse already is?\nThe idea to define such a conditional probability of \\(A\\) given \\(B\\), denoted \\(P(A|B)\\), is to consider \\(B\\) as the new sample space and rescale the probability of events in \\(B\\), such that the new sample space has probability 1:\n\\[P(A|B) = \\frac{P(A \\cap B)}{P(B)}\\]\n\n\n\n\n\n\nExercise: Weather forecast\n\n\n\n\n\nThis table contains the frequency of joint events: weather forecast and actual weather.\n\n\n\n\nsunny forecast\ncloudy forecast\nrainy forecast\n\n\nsunny weather\n0.3\n0.05\n0.05\n\n\ncloudy weather\n0.04\n0.2\n0.02\n\n\nrainy weather\n0.1\n0.04\n0.2\n\n\n\n\nWhich is the probability of a sunny day?\nWhich is the probability that the forecast is wrong?\nWhich is the probability of rain when the forecast is sunny?\n\nHint: remember to use the special case of the additive rule, holding when A and B are disjoint, \\(P(A \\cup B) = P(A) + P(B)\\)\n\n\n\n\nStochastic independence\nThe events \\(A\\) and \\(B\\) are independent if \\(P(A|B) = P(A)\\)\nInterpretation: probability of \\(A\\) is the same if we also know that \\(B\\) has occurred.\n\n\n\n\n\n\nExamples: independence\n\n\n\n\n\nConsider the following:\n\n\\(A\\): Probability of me having the condition\n\\(B\\): Probability of my partner having the same condition\n\nCondition 1: Diabetes, \\(P(A|B) = P(A)\\)\nCondition 2: COVID-19, \\(P(A|B) \\neq P(A)\\)\n\n\n\nProbability calculations can be simplified if there is stochastic independence:\n\\[P(A|B) = \\frac{P(A \\cap B)}{P(B)} = P(A)\\]\n\\[P(A \\cap B) = P(A) \\times P(B)\\]\n\n\n\n\n\n\nExample: Child birth (revisited)\n\n\n\n\n\nTwo children are born, which is the probability that genders are different?\n\\[\\begin{aligned}\nP(\\text{girl and boy}) & =P(\\text{girl then boy}) + P(\\text{boy then girl})\\\\\n& = P(\\text{first is girl}) \\times P(\\text{second is boy}) +\\\\\n&~~~~+ P(\\text{first is boy}) \\times P(\\text{second is girl})\\\\\n& = 1/2 \\times 1/2 + 1^/2 \\times 1/2 = 0.50\n\\end{aligned}\\]\n\n\n\n\n\n\n\n\n\nExample: Dices (revisited)\n\n\n\n\n\nThree dices are tossed, which is the probability of all showing sixes?\n\\[P(\\text{three 6})=1/6 + 1/6 + 1/6 = 1/216 = 0.004\\]\n\n\n\n\n\n\n\n\n\nExercise: Side effects of medication\n\n\n\n\n\nA treatment has a side effect which has a risk of 1/1000. Which is the probability that the side effect does not occur among 1000 patients?\nHint: think about independence."
  },
  {
    "objectID": "course_material/notes_probability.html#total-probability",
    "href": "course_material/notes_probability.html#total-probability",
    "title": "Probability",
    "section": "Total probability",
    "text": "Total probability\nThe law of total probability expresses the probability of an outcome, \\(P(A)\\), which can be realized via two distinct events \\(B\\) and \\(\\bar{B}\\):\n\\[P(A) = P(A|B)P(B) + P(A| \\bar{B})P( \\bar{B})\\]\n\n\n\n\n\n\nDerivation of the law of total probability\n\n\n\n\n\nAny event \\(A\\) can be divided in two with regard to another event \\(B\\):\n\\[A = (A \\cap B) \\cup (A \\cap \\bar{B})\\] \nBecase the two events \\((A \\cap B)\\) and \\((A \\cap \\bar{B})\\) are disjunct, we can write:\n\\[\nP(A) = P(A \\cap B) + P(A \\cap \\bar{B})\n\\]\nUsing the multiplicative rule, we get the law of total probability:\n\\[\nP(A) = P(A|B)P(B) + P(A| \\bar{B})P( \\bar{B})\n\\]\n\n\n\n\n\n\n\n\n\nExample: Gender of twins\n\n\n\n\n\n\nWe want to find the probability of two twins having the same gender.\nMonozygotic twins have the same gender, while dizygotic twins are like any other siblings.\nWe have to take into consideration if the twins are monozygotic or not. For that we use the law of total probability.\n\n\\(A\\) = Both twins have the same gender \\(B\\) = The twins are monozygotic\n\nWe want to find \\(P(A)\\)\nThe probability of twins being monozygotic, \\(P(B)\\), is 1/3.\nThe las of total probability give us:\n\n\\[\n\\begin{aligned}\nP(A) & = P(A|B)P(B) + P(A| \\bar{B})P( \\bar{B})\\\\\n& = 1 \\cdot 1/3 + 1/2 \\cdot 2/3 = 0.67\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "course_material/notes_probability.html#bayes-theorem-also-called-bayes-law",
    "href": "course_material/notes_probability.html#bayes-theorem-also-called-bayes-law",
    "title": "Probability",
    "section": "Bayes’ theorem (also called Bayes’ law)",
    "text": "Bayes’ theorem (also called Bayes’ law)\nGiven two events \\(A\\) and \\(B\\), Bayes theorem states that:\n\\[\nP(B|A)=\\frac{P(A|B)P(B)}{P(A)}\n\\]\n\n\n\n\n\n\nExplain\n\n\n\n\n\nIt was first formulated by Thomas Bayes (1702-1761)\nBayes law relates the conditional probabilities \\(P(B|A)\\) and \\(P(A|B)\\)\n\n\n\n\n\n\n\n\n\nExample Gender of twins (revisited)\n\n\n\n\n\nWhat if we want to find the probability that two twins of the same gender are monozygotic?\nIn other words, what is \\(P(B|A)\\)?\nWe can use Bayes’ law and the law of total probability\n\\[\n\\begin{aligned}P(B|A) & =\\frac{P(A|B)P(B)}{P(A)}\\\\       & =\\frac{P(A|B)P(B)}{P(A|B)P(B) + P(A| \\bar{B})P( \\bar{B})}\\\\       & = \\frac{1 \\cdot 1/3}{1 \\cdot 1/3 + 1/2 \\cdot 2/3} = 0.5\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "course_material/notes_probability.html#bayesian-statistics",
    "href": "course_material/notes_probability.html#bayesian-statistics",
    "title": "Probability",
    "section": "Bayesian statistics",
    "text": "Bayesian statistics\nIn the Bayesian definition of probability, the size of the probability of a given event represents ones degree of belief in the occurrence of the even.\nWhere does Bayes come in? Bayes’ law is used to calculate such probabilities base on on our prior belief and available data:\n\\[\nP(\\theta|data) =\\frac{P(data|\\theta)P(\\theta)}{P(data)}\n\\]\n\n\\(\\theta\\) refers to the parameters in your model (mean, variance, etc.)\nThe prior distribution \\(P(\\theta)\\) is where you put in your prior beliefs\nWhat you want to estimte is the so called posterior distribution \\(P(\\theta|data)\\), the probability distribution of the model parameters given your data.\nThe more data you have, the more will it dominate over your prior belief.\nWhen youy have prior knowledge about your problem, you get to actually use this information\nWhen you know little (or nothing) of your problme, there are anyway many methodological advantages in using Bayesian statistics\nBayesian statistics is not really relevant for simpler problems like in this course, but you will probaly at some point come across articles using Bayesian approaches."
  },
  {
    "objectID": "course_material/notes_distributions.html",
    "href": "course_material/notes_distributions.html",
    "title": "Probability Distributions",
    "section": "",
    "text": "Topics:\nBooks and resources:"
  },
  {
    "objectID": "course_material/notes_distributions.html#discrete-probability-distribution",
    "href": "course_material/notes_distributions.html#discrete-probability-distribution",
    "title": "Probability Distributions",
    "section": "Discrete probability distribution",
    "text": "Discrete probability distribution\nHere we deal with stochastic trials where the set of all possible outcomes is countable and known.\nA discrete random variable maps each of the trial outcomes to a numeric value.\nA discrete probability distribution assigns a probability for each of the possible numeric values representing the outcomes.\nAll possible outcomes for a probability distribution should sum to 1.\n\n\n\n\n\n\nExample: Dice Trowing\n\n\n\n\n\nTrowing a dice has 6 possible outcomes with equal probability. We can define a random variable \\(X\\) that maps each of the outcomes when trowing a dice to the numeric values 1,2,3,4,5,6. The probability distribution \\(P(X=x)\\) assigns the following probabilities to each value \\(X=x\\):\n\n\n\n\\(x\\)\n1\n2\n3\n4\n5\n6\n\n\n\n\n\\(P(X=x)\\)\n1/6\n1/6\n1/6\n1/6\n1/6\n1/6\n\n\n\n\n\n\n\nBernoulli trials\nOften a process has two outcomes.\n\nCoin tossing: outcomes are head or tail.\nHIV test looks for the presence or absence of antibodies in the blood.\nA child is born with a certain condition or not.\n\nOr from a stochastic trial with multiple outcomes, there are two outcomes of interest:\n\nthrow a dice, you are only interested in whether you get a 6 or not.\nA child is born with a weight lower than 2500 grams or not.\n\n\n\nBinomial trials\nA bionomial trial consist of a series of Bernoulli trials that satisfy the following:\n\nIn each trial, we can record whether certain event \\(A\\) occurs or not.\nThe probability of A, \\(P(A)\\) is the same in each trial, it is denoted by \\(p\\).\nAll trials are independent.\n\nSuppose we carry out n trials, looking for an event A in each trial. As a result we obtain a sequence:\n\\[A, \\bar{A}, A, A, \\bar{A}, ..., A\\]\nSay that \\(A\\) takes place \\(x\\) times. This means \\(\\bar{A}\\) takes place \\(n-x\\) times.\nWhat is the probability for a certain sequence?\nRecall that probabilities for independent events can be multiplied.\n\\[P(sequence) = p \\times (1-p) \\times p ... \\times p\\]\nFor \\(x\\) number of \\(p\\) and \\(n-x\\) number of \\(1-p\\),\n\\[P(sequence) = p^{x} (1-p)^{n-x}\\]\nThe order of the sequence does not matter. The number of occurence matters. The number of ways that \\(x\\) objects can be chosen from a total of \\(n\\) objects, regardless of order is given by the bionomical coefficient.\n\n\nBinomial coefficient\nWe want to find the number of ways that \\(x\\) objects can be chosen from a total of \\(n\\) objects, regardless of order\nBinomial coefficient: \\(\\binom nx\\)\n\\[\\binom nx = \\frac{n!}{x!(n-x)!}\\]\n“x factorial”: \\(x! = x \\times (x-1) \\times ... 2 \\times 1\\)\nExample: \\(\\binom 4 3 = \\frac{4\\times 3 \\times 2 \\times 1}{3 \\times 2 \\times 1 \\times 1} = 4\\)"
  },
  {
    "objectID": "course_material/notes_distributions.html#binomial-distribution",
    "href": "course_material/notes_distributions.html#binomial-distribution",
    "title": "Probability Distributions",
    "section": "Binomial distribution",
    "text": "Binomial distribution\nThe probability that \\(A\\) occurs exact \\(x\\) times is given by\n\\[P(X = x) = \\binom n x p^{x}(1-p)^{n-x}\\]\ni.e. the number of distributing \\(x\\) events in a sequence of length \\(n\\), times the probability that one particular sequence with \\(x\\) events occurs.\nFor a binomial distribution, the mean (or expected value) is \\(np\\) and the variance is \\(np(1-p)\\).\n\n\n\n\n\n\nExample: Number of positive tests\n\n\n\n\n\nLet’s say \\(p=0.15\\) is the probability that a person taking a test for a certain disease get a positive result. A certain day, we are going to do \\(n=8\\) such tests. The number of positive test in a sequence of of 8 test is random variable that is binomially distributed, often written Bin(8,0.15). This binomial distribution can be represented as below.\n\n\n\nBin(8,0.15)\n\n\n\nWhat is the probability that you get 2 or more positives?\nWhat is the expected number of positive tests (the mean)?\nWhat is the variance and the standard deviation?\n\n\n\n\n\n\n\n\n\n\nExample: Family with four kids\n\n\n\n\n\nWe consider a family with 4 kids, with no monozygotic twins, so the gender of the kids are approximately independent. The probability of getting a boy in Norway is approximately 0.514. Using the formula for the binomial distribution we can compute the probability that that out of the 4 kids the number of boys is 0, 1, 2, 3 or 4 as follwos:\n$$ P(X=0)= 0 0.514^0 ^4 = 0.0557\n\\[ \\]\nP(X=1)= 1 0.51^1 ^3 = 0.2360 $$\n$$ P(X=2)= 2 0.51^2 ^2 = 0.3744\n\\[ \\]\nP(X=3)= 3 0.51^3 ^1 = 0.2639\n\\[ \\]\nP(X=4)= 4 0.51^4 ^0 = 0.0697 $$\nIn the following table we compare our theoretical estimates with real-life percentage distribution in 7745 American families with 4 kids.\n\nSource: Aalen et al.\n\n\n\n\n\n\n\nNumber of boys\nBinomial distribution (\\(\\%\\))\nObserved distribution (\\(\\%\\))\n\n\n\n\n0\n5.6\n5.3\n\n\n1\n23.6\n22.9\n\n\n2\n37.4\n38.3\n\n\n3\n26.4\n26.5\n\n\n4\n7.0\n6.9"
  },
  {
    "objectID": "course_material/notes_distributions.html#probability-distribution-revisited",
    "href": "course_material/notes_distributions.html#probability-distribution-revisited",
    "title": "Probability Distributions",
    "section": "Probability distribution revisited",
    "text": "Probability distribution revisited\nProbability mass and density. Compare binomial and a continuous dist visually\n\n\n\n\n\n\nExplain\n\n\n\nRevisit the previous section on discrete variables"
  },
  {
    "objectID": "course_material/notes_distributions.html#normal-distribution-1",
    "href": "course_material/notes_distributions.html#normal-distribution-1",
    "title": "Probability Distributions",
    "section": "Normal distribution",
    "text": "Normal distribution\nImportant distribution:\n\napplication 1\napplication 2\n\nProbability density function\n\\[f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}} exp(- \\frac{(x-\\mu)^2}{2\\sigma^2})\\]\n\n\\(\\mu\\) is the mean\n$$ is the standard deviation\n\\(exp(x) = e^{x}\\)\n\n\n\nProperties\n\nSymmetric, bell-shape\n\\(\\mu\\) and \\(\\sigma\\) define the location and variation\nFrom the center (mean), going two standard deviations each way covers approximately 95% of the distribution\n\n\n\n\n\n\n\nExamples\n\n\n\nSome other parameters\n\n\n\n\nStandard normal distribution\nA normal distribution \\(N(\\mu, \\sigma)\\) with \\(\\mu = 0, \\sigma = 1\\)\nAny normal disribution can be transformed into a standard normal distribution \\(N(0, 1)\\): if \\(X \\sim N(\\mu, \\sigma)\\), then\n\\[Y = \\frac{X-\\mu}{\\sigma} \\sim N(0, 1)\\]\nStandard normal distribution probabilities are commonly presented in tables, so people can check them easily.\n\n\n\n\n\n\nExamples\n\n\n\nbirthweight, compute proportions"
  },
  {
    "objectID": "course_material/notes_distributions.html#normal-approximation-to-the-binomial-distribution",
    "href": "course_material/notes_distributions.html#normal-approximation-to-the-binomial-distribution",
    "title": "Probability Distributions",
    "section": "Normal approximation to the binomial distribution",
    "text": "Normal approximation to the binomial distribution\nRecall the binomial distribution,\n\\[P(X = x) = \\binom nx p^x (1-p)^{n-x}\\]\nwhere \\(\\binom nx = \\frac{n!}{x!(n-x)!}\\), and \\(\\binom n 0 = 1\\)\nFor large \\(n\\), the binomial distribution can be approximated by the normal distribution.\n\n\n\nHistograms of the binomial distribution with p=0.2 and different n.\n\n\n\n\nTo approximate a binomial distribution we use a normal distribution with:\n\n\\(\\mu = np\\)\n\\(\\sigma = \\sqrt{np(1-p)}\\)\n\n\n\n\n\n\n\nExample: Number of boys out of 20 new borns\n\n\n\n\n\n\n\\(n=20\\), \\(p=0.514\\)\n\\(\\mu=np=20 \\cdot 0.514 = 10.28\\)\n\\(\\sigma = \\sqrt{np(1-p)} = \\sqrt{20 \\cdot 0.514 \\cdot 0.486} = 2.24\\)\n\\(N(10.28,2.24)\\)\n\n\n\n\n\nRule of thumb:\n\\(Binom(n, p) \\rightarrow N(\\mu, \\sigma)\\quad \\text{for} \\quad n \\rightarrow \\infty\\) if \\(np \\geq 5\\) and \\(n(1-p) \\geq 5\\)\n\n\nCentral limit theorem CLT\nCLT in simple words: the distribution of sample mean will be nearly normal regardless of what distribution the variable in the population is, as long as the sample size is large enough."
  },
  {
    "objectID": "course_material/notes_distributions.html#continuous-probability-distribution",
    "href": "course_material/notes_distributions.html#continuous-probability-distribution",
    "title": "Probability Distributions",
    "section": "Continuous probability distribution",
    "text": "Continuous probability distribution\nHere we deal with continuous stochastic variables. In contrast to counting variables, continuous variables can take any (of the infinite) values within a given range. For instance, height, cholesterol and annual salary can be considered continuous variables.\nA probability distribution (or density) for a continuous variable \\(X\\) is a function \\(f\\) satistying the following:\n\n\\(f(x)\\geq 0~~\\text{for all}~~x~~\\text{in}~~X\\).\nThe total area under the curve of \\(f\\) is 1.\nThe probability that \\(x\\) is between two values \\(a\\) and \\(b\\), denoted \\(P(a\\leq x \\leq b)\\) equals the area under the curve from \\(a\\) to \\(b\\).\n\n\n\n\nProbability density for a continuous variable"
  },
  {
    "objectID": "course_material/notes_distributions.html#normal-distribution",
    "href": "course_material/notes_distributions.html#normal-distribution",
    "title": "Probability Distributions",
    "section": "Normal distribution",
    "text": "Normal distribution\nThis is the most important probability distribution in statistics. It will be widely used in this course.\nProbability density function of the normal distribution has this formula:\n\\[f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\text{exp}(- \\frac{(x-\\mu)^2}{2\\sigma^2})\\]\n\n\\(\\mu\\) is the mean\n\\(\\sigma\\) is the standard deviation\n\\(\\text{exp}(x) = e^{x}\\)\n\n\nProperties of the normal distribution\n\n\n\n\n\n\nSymmetric, bell-shape\n\\(\\mu\\) and \\(\\sigma\\) define the location and variation\nFrom the center (mean), going two standard deviations each way covers approximately 95% of the distribution\n\n\n\n\n\n\n\nExamples: location \\(\\mu\\), variation \\(\\sigma\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStandard normal distribution\nA normal distribution \\(N(\\mu, \\sigma)\\) with \\(\\mu = 0, \\sigma = 1\\)\nAny normal disribution can be transformed into a standard normal distribution \\(N(0, 1)\\) by substracting the meand and dividing by the standard deviation:\nif \\(X \\sim N(\\mu, \\sigma)\\), then \\(Y = \\frac{X-\\mu}{\\sigma} \\sim N(0, 1)\\).\nStandard normal distribution probabilities are commonly presented in tables, so people can check them easily. But in this course we will learn how to compute them with R.\n\n\n\n\n\n\nExamples: Birthweight\n\n\n\n\n\nThis figure shows the brithweight of 189 newborns\n\n\n\n\n\n\nEstimates of $\\mu$ and $\\sigma$ are, respectively, 2945g and 729g\nHow can we compute the proportion of weights larger than 4000g?\n\nWe can either compute it directly in R as we will see in the R lab, or we can use the normal tables as follows:\n\\[\nP(Y>4000) = 1- P(X \\leq 4000) = 1 - P(\\frac{X-2945}{729} \\leq 1.45)\n\\]\nAs the variable \\(\\frac{X-2945}{729}\\) is distributed according to the standard normal distribution, the probability \\(P(\\frac{X-2945}{729} \\leq 1.45)\\) can be found in the tables, see Aalen p.328.\n\\[\n\\begin{aligned}\nP(Y>4000) & = 1- P(X \\leq 4000) = 1 - P(\\frac{X-2945}{729} \\leq 1.45)\\\\\n          & = 1 - 0.9265 = 0.0735\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "course_material/notes_probability.html#probability-calculations",
    "href": "course_material/notes_probability.html#probability-calculations",
    "title": "Probability",
    "section": "Probability calculations",
    "text": "Probability calculations\n\nStochastic trial, events and sample space.\nA stochastic trial is characterized by an uncertain outcome.\nAll possible outcomes in a stochastic trial make up the sample space.\nAn event can be a single outcome, or a collection of single outcomes.\nEach event has a probability of ocurrence between 0 and 1. A probability equal to 0 means that the event can never occur, and equal to 1 means that the event is certeinly occuring.\nThe sum of all probabilities in a sample space equals 1.\n\n\n\n\n\n\nExamples: Stochastic trials\n\n\n\n\n\nDice tossing\n\nSample space: {1,2,3,4,5,6}\nEvents:\n\nEven number of eyes: {2,4.6}\nMore than 3 eyes: {4,5,6}\n\n\nChild birth\n\nSample space: {B,G}\nEvents:\n\nHaving a girl: {G}\nNot having a girl: {B}\n\n\nDiastolic blood pressure\n\nSample space: {40,41,…,119,120}\nEvent:\n\nHypertension: {91,92, …, 120}\n\n\n\n\n\n\n\nVenn diagram\nVenn diagrams are often used to illustrate events. In the figures below A and B represent different events and S is the sample space.\n\n\n\n\n\n\n\n\n\n\n\n\nOperators on events:\n\nUnion: \\(A \\cup B\\)\nIntersection: \\(A \\cap B\\)\nComplement: \\(\\bar{A}\\)\n\n\n\n\n\n\n\n\n Union: \\(A \\cup B\\)\n Intersection: \\(A \\cap B\\)\n\n\n\n\n\n\n\n\n\n\n Complement: \\(\\bar{A}\\)\n Combining operators: \\(A \\cap \\bar{B}\\)\n\n\n\n\n\nProbability calculation rules\nThe probability of an event \\(A\\) is denoted by \\(P(A)\\). It has a value between 0 and 1. The probability over the whole sample space equals 1.\nComplement rule\n\\[P(A) + P(\\bar{A}) = 1\\]\nAdditive rule\nThe occurrence of at least one of the events \\(A\\) or \\(B\\) is \\[P(A \\cup B) = P(A) + P(B) - P(A \\cap B)\\] For disjoint events \\(A\\) and \\(B\\), \\(P(A \\cap B) = 0\\). Hence \\[P(A \\cup B) = P(A) + P(B)\\]\nMultiplicative rule\nProbability of independent events can be multiplied\n\\[P(A \\cap B) = P(A) \\times P(B)\\]\n\n\n\n\n\n\nExample: Child gender in two births\n\n\n\n\n\nWhat is the probability of giving birth to at least one girl?\n\nWe assume the probability of giving birth to a girl is 0.5.\nWe assume that the two births are independent events.\n\n\\[\n\\begin{aligned}\nP(\\text{at least one girl}) & =P(\\text{1st child is girl}) + P(\\text{2nd child is girl})-P(\\text{both are girls}) \\\\\n& = 1/2 + 1/2 - 1/2 \\times 1/2 = 3/4\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nExamples: Tossing two dices\n\n\n\n\n\n\nThe two throws are independent events.\nThere are 36 equally possible outcomes.\nOnly one outcome corresponds to the double 6 event.\n\nWhat is the probability of getting 6 in the first AND the second throw? $$ P() = 1/6 /6 = 1/36\n$$\nWhat is the probability of getting at least one 6 in two throws? \\[\n\\begin{aligned}\n    P(\\text{at least one 6 in 2 trows}) &=P(\\text{6 in the first}) +         P(\\text{6 in the second}) - P(\\text{6 in both})\\\\\n    &=1/6 +1/6 - 1/36 =0.31\n\\end{aligned}\n\\]\nWhat is the probability of not getting any 6 in two throws? $$\n\\[\\begin{aligned}\n    P(\\text{not getting any 6 in 2 trows}) &= 1 - P(\\text{at least one 6 in 2 trows})\\\\\n    &= 1 - 0.31 = 0.69\n\\end{aligned}\\]\n$$"
  },
  {
    "objectID": "course_material/notes_probability.html#stochastic-independence",
    "href": "course_material/notes_probability.html#stochastic-independence",
    "title": "Probability",
    "section": "Stochastic independence",
    "text": "Stochastic independence\nThe events \\(A\\) and \\(B\\) are independent if\n$$\nP(A|B) = P(A)\n$$\nInterpretation: probability of \\(A\\) is the same if we also know that \\(B\\) has occurred.\n\n\n\n\n\n\nExamples: independence\n\n\n\n\n\nConsider the following:\n\n\\(A\\): Probability of me having the condition\n\\(B\\): Probability of my partner having the same condition\n\nCondition 1: Diabetes, \\(P(A|B) = P(A)\\)\nCondition 2: COVID-19, \\(P(A|B) \\neq P(A)\\)\n\n\n\nProbability calculations can be simplified if there is stochastic independence:\n$$\nP(A|B) = = P(A)\n$$\n$$\nP(A B) = P(A) P(B)\n$$\n\n\n\n\n\n\nExample: Child birth (revisited)\n\n\n\n\n\nTwo children are born, which is the probability that genders are different?\n$$\n\\[\\begin{aligned}\nP(\\text{girl and boy}) & =P(\\text{girl then boy}) + P(\\text{boy then girl})\\\\\n& = P(\\text{first is girl}) \\times P(\\text{second is boy}) +\\\\\n&~~~~+ P(\\text{first is boy}) \\times P(\\text{second is girl})\\\\\n& = 1/2 \\times 1/2 + 1^/2 \\times 1/2 = 0.50\n\\end{aligned}\\]\n$$\n\n\n\n\n\n\n\n\n\nExample: Dices (revisited)\n\n\n\n\n\nThree dices are tossed, which is the probability of all showing sixes?\n$$\nP()=1/6 + 1/6 + 1/6 = 1/216 = 0.004\n$$\n\n\n\n\n\n\n\n\n\nExercise: Side effects of medication\n\n\n\n\n\nA treatment has a side effect which has a risk of 1/1000. Which is the probability that the side effect does not occur among 1000 patients?\nHint: think about independence."
  }
]