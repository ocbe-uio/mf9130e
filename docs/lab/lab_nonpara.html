<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Wilcoxon signed rank, rank sum test">

<title>MF9130E - V23 - Non-parametric tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MF9130E - V23</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../get_started/get_started.html">
 <span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../course_material/course_material_overview.html">
 <span class="menu-text">Course material</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../lab/overview.html">
 <span class="menu-text">R Lab and Code</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ocbe-uio/teaching_mf9130e"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#short-summary" id="toc-short-summary" class="nav-link active" data-scroll-target="#short-summary">Short summary</a></li>
  <li><a href="#examples-exercises-with-solution" id="toc-examples-exercises-with-solution" class="nav-link" data-scroll-target="#examples-exercises-with-solution">Examples (exercises with solution)</a>
  <ul class="collapse">
  <li><a href="#exercise-1-lung-function" id="toc-exercise-1-lung-function" class="nav-link" data-scroll-target="#exercise-1-lung-function">Exercise 1 (lung function)</a>
  <ul class="collapse">
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">1a)</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">1b)</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">1c)</a></li>
  </ul></li>
  <li><a href="#exercise-2-length-of-hospital-stay" id="toc-exercise-2-length-of-hospital-stay" class="nav-link" data-scroll-target="#exercise-2-length-of-hospital-stay">Exercise 2 (length of hospital stay)</a>
  <ul class="collapse">
  <li><a href="#a-1" id="toc-a-1" class="nav-link" data-scroll-target="#a-1">2a)</a></li>
  <li><a href="#b-1" id="toc-b-1" class="nav-link" data-scroll-target="#b-1">2b)</a></li>
  <li><a href="#c-1" id="toc-c-1" class="nav-link" data-scroll-target="#c-1">2c)</a></li>
  </ul></li>
  <li><a href="#exercise-3-antibody" id="toc-exercise-3-antibody" class="nav-link" data-scroll-target="#exercise-3-antibody">Exercise 3 (antibody)</a>
  <ul class="collapse">
  <li><a href="#a-2" id="toc-a-2" class="nav-link" data-scroll-target="#a-2">3a)</a></li>
  <li><a href="#optional" id="toc-optional" class="nav-link" data-scroll-target="#optional">(Optional)</a></li>
  <li><a href="#b-2" id="toc-b-2" class="nav-link" data-scroll-target="#b-2">3b)</a></li>
  </ul></li>
  <li><a href="#exercise-4-nausea" id="toc-exercise-4-nausea" class="nav-link" data-scroll-target="#exercise-4-nausea">Exercise 4 (nausea)</a>
  <ul class="collapse">
  <li><a href="#a-3" id="toc-a-3" class="nav-link" data-scroll-target="#a-3">4a)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Non-parametric tests</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    Wilcoxon signed rank, rank sum test
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Datasets</p>
<ul>
<li>Exercise 1: <code>PEFH98-english</code> (<a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/PEFH98-english.rda">rda link</a>, <a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/PEFH98-english.csv">csv link</a>)</li>
<li>Exercise 2: <code>liggetid</code> (<a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/liggetid.rda">rda link</a>, <a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/liggetid.csv">csv link</a>)</li>
<li>Exercise 3: <code>antibody</code> (<a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/antibody.rda">rda link</a>, <a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/antibody.csv">csv link</a>)</li>
<li>Exercise 4: <code>nausea</code> (<a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/nausea.rda">rda link</a>, <a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/nausea.csv">csv link</a>)</li>
</ul>
<p><a href="https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/code/6_nonpara.R">R script</a></p>
<hr>
<section id="short-summary" class="level1">
<h1>Short summary</h1>
<p>When you have data that are not normally distributed, such as time data (e.g.&nbsp;length of hospital stay, survival data), you should be careful when using statisical tests based on normal assumption.</p>
<p>Alternatively, transform your data (log transform for right-skewed data) before carrying out statistical tests; or use non-parametric (rank based) methods.</p>
<ul>
<li>One sample / paired sample: Wilcoxon signed rank test</li>
<li>Two samples (independent samples): Wilcoxon rank sum test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median ci (with descTools package)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">MedianCI</span>(x, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one sample (paired samples) wilcoxon test (signed rank)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1, x2, <span class="at">paired =</span> T)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># two sample (independent) wilcoxon test (rank sum)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y, <span class="at">paired =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="examples-exercises-with-solution" class="level1">
<h1>Examples (exercises with solution)</h1>
<section id="exercise-1-lung-function" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-lung-function">Exercise 1 (lung function)</h2>
<p>Lung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.</p>
<p>The variables are</p>
<ul>
<li>Age (years)</li>
<li>Gender (female, 2 male)</li>
<li>Height (cm)</li>
<li>Weight (kg)</li>
<li>PEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)</li>
<li>PEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)</li>
<li>Mean of the three measurements made in a sitting position (pefsitm)</li>
<li>Mean of the three measurements made in a standing position (pefstam)</li>
<li>Mean of all six PEF values (pefmean)</li>
</ul>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">1a)</h3>
<p>We shall consider the difference betweenn PEF measured in a sitting position and in a standing position, i.e.&nbsp;we look at <code>diff_pef = pefstam - pefsitm</code>. First compute this variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lung_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/PEFH98-english.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lung_data, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age gender height weight pefsit1 pefsit2 pefsit3 pefsta1 pefsta2 pefsta3
1  20 female    165     50     400     400     410     410     410     400
2  20   male    185     75     480     460     510     520     500     480
3  21   male    178     70     490     540     560     470     500     470
   pefsitm  pefstam  pefmean
1 403.3333 406.6667 405.0000
2 483.3333 500.0000 491.6667
3 530.0000 480.0000 505.0000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diff_pef</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>diff_pef <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefstam <span class="sc">-</span> lung_data<span class="sc">$</span>pefsitm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">1b)</h3>
<p>Make a histogram and Q-Q plot for the differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(diff_pef)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diff_pef)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(diff_pef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-1b-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">1c)</h3>
<p>Do a non-parametric test to decide whether <code>pefsitm</code> and <code>pefstam</code> are significantly different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one sample (signed rank test)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(diff_pef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  diff_pef
V = 3547.5, p-value = 7.032e-05
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pefstam <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefstam</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pefsitm <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefsitm</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(pefstam, pefsitm, <span class="at">paired =</span> T) <span class="co"># paired </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pefstam and pefsitm
V = 3547.5, p-value = 7.032e-05
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the data is not severly skewed, can also use t-test </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pefstam, pefsitm, <span class="at">paired =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  pefstam and pefsitm
t = 3.6974, df = 104, p-value = 0.0003498
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
  4.423204 14.656161
sample estimates:
mean difference 
       9.539683 </code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-2-length-of-hospital-stay" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-length-of-hospital-stay">Exercise 2 (length of hospital stay)</h2>
<p>The data was collected at the Geriatric Department at Ullevål Sykehus. Below is a description of the data set <code>liggetid</code>. The file includes the following variables:</p>
<ul>
<li>Year of birth (faar)</li>
<li>Month of birth (fmaan)</li>
<li>Day of birth (fdag)</li>
<li>Year of hospital admission (innaar)</li>
<li>Month of admission (innmaan)</li>
<li>Day of admission (inndag)</li>
<li>Year of discharge from hospital (utaar)</li>
<li>Month of discharge (utmaan)</li>
<li>Day of discharge (utdag)</li>
<li>Gender, where 1 = male and 0 = female (kjoenn)</li>
<li>Admission from, where 1 = home, 2 = Div. of Medicine, 3 = Div. of Surgery, 4 = Other division, 5 = Other hospital, 6 = Nursing home (kom_fra)</li>
<li>Stroke, where 1 = yes, 0 = no (slag)</li>
<li>Age (alder)</li>
<li>Hospital stay, in days (liggetid)</li>
<li>Logarithm of hospital stay (lnliggti)</li>
<li>Comes from Div. of Medicine (kom_fra2)</li>
<li>Comes from Div. of Surgery (kom_fra3)</li>
<li>Comes from Other division (kom_fra4)</li>
<li>Comes from Other hospital (kom_fra5)</li>
<li>Comes from Nursing home (kom_fra6)</li>
<li>Censoring variable (censor)</li>
</ul>
<p>The variable <code>liggetid</code> time is calculated from the <code>innaar</code>, <code>innmaan</code>, <code>inndag</code>, <code>utaar</code>, <code>utmaan</code> and <code>utdag</code> variables.</p>
<section id="a-1" class="level3">
<h3 class="anchored" data-anchor-id="a-1">2a)</h3>
<p>We want to compare the <strong>length of hospital stay</strong> for patients with and without <strong>stroke</strong>. First get a better understanding of the data. Start with computing some summary (descriptive) statistics for these two variables:</p>
<ul>
<li><strong>mean, median, min, max, 75-th percentile</strong> for length of hospital stay (<code>liggetid</code>);</li>
<li><strong>count</strong> of how many patient have stroke, and do not have stroke (<code>slag == 1</code> or <code>0</code>)</li>
</ul>
<p>Visualize the variable <code>liggetid</code> using histogram and Q-Q plot, is the requirement for t-test met?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>liggetid <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/liggetid.csv'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(liggetid, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  faar fmaan fdag innaar innmaan inndag utaar utmaan utdag kjoenn kom_fra slag
1 1906     3    4   1987       3      5    87      3    18 kvinne       1    0
2 1891     4    3   1987       3      6    87      3    23 kvinne       1    0
3 1908     9    6   1987       3     10    87      3    16 kvinne       1    0
  alder liggetid lnliggti kom_fra2 kom_fra3 kom_fra4 kom_fra5 kom_fra6 status
1    81       13 2.564949        0        0        0        0        0      1
2    96       17 2.833213        0        0        0        0        0      1
3    79        6 1.791759        0        0        0        0        0      1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># liggetid (length of stay: los)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>los <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>liggetid</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>stroke <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>slag</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(los)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    1.0    21.0    42.0   117.1   102.0  1215.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stroke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stroke
  0   1 
891 163 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stroke) <span class="co"># this shows 85 missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
 0.0000  0.0000  0.0000  0.1547  0.0000  1.0000      85 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(stroke)) <span class="co"># 85</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize length of hospital stay (los)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(los, <span class="at">breaks =</span> <span class="dv">25</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(los, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(los, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-2a-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b-1" class="level3">
<h3 class="anchored" data-anchor-id="b-1">2b)</h3>
<p>Since we want to compare the length of hospital stay for two groups, we need to separate the length of stay data into two groups, based on whether patients have stroke or not. Create two variables, <code>ligt_s1</code> and <code>ligt_s0</code>.</p>
<p>Do an appropriate non-parametric test. What is the difference between this test and the one you did in Exercise 1?</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Separate one variable via index and <code>which()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Previously, we showed how to separate one variable based on another,</p>
<ul>
<li>Exercise 2c) in <a href="https://ocbe-uio.github.io/teaching_mf9130e/lab/lab_eda_part1.html">EDA I</a></li>
<li>Exercise 2a) in <a href="https://ocbe-uio.github.io/teaching_mf9130e/lab/lab_categorical.html">Categorical data analysis</a></li>
</ul>
<p>You can try to use this method here as well; but you might notice that there are some NA in the results. This is because when you do <code>stroke == 0</code> on NA, instead of giving you <code>T</code> or <code>F</code>, it gives <code>NA</code>; so the result of filtering <code>liggetid</code> keeps both <code>T</code> and <code>NA</code>.</p>
<p>These NAs can be removed post-hoc; but a clearer solution is to set 2 conditions inside the square bracket, and combine with <code>&amp;</code>.</p>
<ul>
<li><code>!is.na(stroke)</code> means stroke variable not NA</li>
<li><code>stroke == 1</code> means stroke variable equals to 1</li>
<li><code>which()</code> identifies the indices for stroke where the conditions were met, e.g.&nbsp;the 4th, 22th elements.</li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate los </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ligt_s1 <span class="ot">&lt;-</span> los[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ligt_s0 <span class="ot">&lt;-</span> los[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">0</span>)]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mean, median </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(ligt_s1), <span class="fu">median</span>(ligt_s1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 145.0123  58.0000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(ligt_s0), <span class="fu">median</span>(ligt_s0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 116.7722  40.0000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># s1</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ligt_s1, <span class="at">main =</span> <span class="st">'Length of hospital stay, stroke yes'</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'mean: 145; median: 58'</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1300</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(ligt_s1), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(ligt_s1), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">'dashed'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(ligt_s1, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay, stroke yes'</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(ligt_s1, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># s0</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ligt_s0, <span class="at">main =</span> <span class="st">'Length of hospital stay, stroke no'</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'mean: 116; median: 40'</span>, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1300</span>))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(ligt_s0), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(ligt_s0), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">'dashed'</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(ligt_s0, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay, stroke no'</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(ligt_s0, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-2b-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># non parametric test</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># not matched; independent samples</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wilcoxon rank sum </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(ligt_s1, ligt_s0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  ligt_s1 and ligt_s0
W = 84060, p-value = 0.001361
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Compare with t-test
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you do a t-test (inappropriately) instead of Mann-Whitney U test, you’ll have different results!</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test on skewed data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ligt_s1, ligt_s0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  ligt_s1 and ligt_s0
t = 1.5847, df = 220.8, p-value = 0.1145
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -6.879646 63.359853
sample estimates:
mean of x mean of y 
 145.0123  116.7722 </code></pre>
</div>
</div>
</section>
<section id="c-1" class="level3">
<h3 class="anchored" data-anchor-id="c-1">2c)</h3>
<p>Do the same analysis with a t-test on the logarithm-transformed data. The transformed variable already exists in the data set as <code>lnliggti</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use log transformed </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>loglos <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>lnliggti</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(loglos, <span class="at">main =</span> <span class="st">'Log transformed length of stay'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-2c-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(loglos, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for log(length of stay)'</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(loglos, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-2c-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>logligt_s1 <span class="ot">&lt;-</span> loglos[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>logligt_s0 <span class="ot">&lt;-</span> loglos[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">0</span>)]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(logligt_s1, logligt_s0, <span class="at">paired =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  logligt_s1 and logligt_s0
t = 3.4218, df = 237.88, p-value = 0.0007321
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1587474 0.5895572
sample estimates:
mean of x mean of y 
 4.180085  3.805933 </code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-3-antibody" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-antibody">Exercise 3 (antibody)</h2>
<p>(Baker et al., 1980) We have data on concentration of antibody of Type III Group B Streptococcus (GBS) in 20 volunteers before and after immunization. The dataset is <code>antibody</code>.</p>
<section id="a-2" class="level3">
<h3 class="anchored" data-anchor-id="a-2">3a)</h3>
<p>The comparison of the antibody levels was summarized in the report of this study as ‘<span class="math inline">\(t = 1.8; P &gt; 0.05\)</span>’. Comment on the result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>antibody <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/antibody.csv'</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(antibody)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  before after
1    0.4   0.4
2    0.4   0.5
3    0.4   0.5
4    0.4   0.9
5    0.5   0.5
6    0.5   0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>before <span class="ot">&lt;-</span> antibody<span class="sc">$</span>before</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> antibody<span class="sc">$</span>after</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compute some summary statistics for the two variables, and then reproduce the result by the t-test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># some summary stat of the data</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.400   0.500   0.600   0.745   0.900   2.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(after)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.400   0.500   0.850   1.925   1.375  12.200 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce the result from t-test</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(antibody<span class="sc">$</span>before, antibody<span class="sc">$</span>after, <span class="at">paired =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  antibody$before and antibody$after
t = -1.8498, df = 19, p-value = 0.07996
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.5151563  0.1551563
sample estimates:
mean difference 
          -1.18 </code></pre>
</div>
</div>
</section>
<section id="optional" class="level3">
<h3 class="anchored" data-anchor-id="optional">(Optional)</h3>
<p>We can visually get an understanding of whether this result makes sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># long format data (requires tidyr package)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>antibody_longdata <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(antibody, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">cols =</span> tidyr<span class="sc">::</span><span class="fu">everything</span>(), </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">names_to =</span> <span class="st">'group'</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">values_to =</span> <span class="st">'measurements'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(antibody_longdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  group  measurements
  &lt;chr&gt;         &lt;dbl&gt;
1 before          0.4
2 after           0.4
3 before          0.4
4 after           0.5
5 before          0.4
6 after           0.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(measurements <span class="sc">~</span> group, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> antibody_longdata, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> T, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Before and after measurements'</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the y axis (horizontal x axis)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(measurements <span class="sc">~</span> group, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> antibody_longdata, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> T, </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Limit the measurement range'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-3a-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(before, <span class="at">main =</span> <span class="st">'Measurements: before'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(before, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for measurements: before'</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(before, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(after, <span class="at">main =</span> <span class="st">'Measurements: after'</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(after, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for measurements: after'</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(after, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-3a-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for the difference s</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(after <span class="sc">-</span> before, <span class="at">main =</span> <span class="st">'Difference (after - before)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-3a-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b-2" class="level3">
<h3 class="anchored" data-anchor-id="b-2">3b)</h3>
<p>Analyse the data with an appropriate test. Justify your choice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matched data (paired)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sample test (signed rank)</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(before, after, <span class="at">paired =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(before, after, paired = T): cannot compute exact
p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(before, after, paired = T): cannot compute exact
p-value with zeroes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  before and after
V = 2, p-value = 0.00412
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the error means there are ties (no change)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Paired vs independent data
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can try to do a test treating the data as independent. The conclusion could be different! Be careful with what you are testing.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what happens if you use independent two-samples test?</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(before, after, <span class="at">paired =</span> F) <span class="co"># p = 0.14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(before, after, paired = F): cannot compute exact
p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  before and after
W = 146.5, p-value = 0.1454
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-4-nausea" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-nausea">Exercise 4 (nausea)</h2>
<p>(Williams et al., 1989) Patients receiving chemotherapy as outpatients were randomized to receive either an active antiemetic treatment or placebo. The following table shows measurements (in mm) on a 100mm linear analogue self-assessment scale for nausea. The dataset is <code>nausea</code>.</p>
<ul>
<li>group: <code>1</code> is active (treatment), and <code>2</code> is placebo.</li>
</ul>
<section id="a-3" class="level3">
<h3 class="anchored" data-anchor-id="a-3">4a)</h3>
<p>Choose an appropriate test for comparing the treatment and placebo groups. Justify your choice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>nausea <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/nausea.csv'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nausea)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  value group
1     0     1
2     0     1
3     0     1
4     0     1
5     0     1
6     2     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> nausea<span class="sc">$</span>value[nausea<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> nausea<span class="sc">$</span>value[nausea<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.50   14.00   16.95   21.25   76.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(placebo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   26.25   47.50   47.10   68.75   95.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these samples are not matched: two sample independent test</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(value <span class="sc">~</span> group, <span class="at">data =</span> nausea, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Nausea: treatment vs placebo'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab_nonpara_files/figure-html/nonpara-4a-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(treatment, placebo, <span class="at">paired =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(treatment, placebo, paired = F): cannot compute
exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  treatment and placebo
W = 78.5, p-value = 0.001039
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Non-parametric tests"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Wilcoxon signed rank, rank sum test"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>Datasets</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 1: <span class="in">`PEFH98-english`</span> (<span class="co">[</span><span class="ot">rda link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/PEFH98-english.rda)</span>, <span class="co">[</span><span class="ot">csv link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/PEFH98-english.csv)</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 2: <span class="in">`liggetid`</span> (<span class="co">[</span><span class="ot">rda link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/liggetid.rda)</span>, <span class="co">[</span><span class="ot">csv link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/liggetid.csv)</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 3: <span class="in">`antibody`</span> (<span class="co">[</span><span class="ot">rda link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/antibody.rda)</span>, <span class="co">[</span><span class="ot">csv link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/antibody.csv)</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 4: <span class="in">`nausea`</span> (<span class="co">[</span><span class="ot">rda link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/nausea.rda)</span>, <span class="co">[</span><span class="ot">csv link</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/data/nausea.csv)</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">R script</span><span class="co">](https://github.com/ocbe-uio/teaching_mf9130e/blob/main/lab/code/6_nonpara.R)</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>------------------</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># Short summary</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>When you have data that are not normally distributed, such as time data (e.g. length of hospital stay, survival data), you should be careful when using statisical tests based on normal assumption.</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>Alternatively, transform your data (log transform for right-skewed data) before carrying out statistical tests; or use non-parametric (rank based) methods.</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>One sample / paired sample: Wilcoxon signed rank test </span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Two samples (independent samples): Wilcoxon rank sum test</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a><span class="co"># median ci (with descTools package)</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">MedianCI</span>(x, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co"># one sample (paired samples) wilcoxon test (signed rank)</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1, x2, <span class="at">paired =</span> T)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="co"># two sample (independent) wilcoxon test (rank sum)</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y, <span class="at">paired =</span> F)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examples (exercises with solution)</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 1 (lung function)</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>Lung function has been measured on 106 medical students. Peak expiratory flow rate (PEF, measured in liters per minute) was measured three times in a sittinng position, and three times in a standing position.</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>The variables are </span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Age (years)</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Gender (female, 2 male)</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Height (cm)</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Weight (kg)</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>PEF measured three times in a sitting position (pefsit1, pefsit2, pefsit3)</span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>PEF measured three times in a standing position (pefsta1, pefsta2, pefsta3)</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mean of the three measurements made in a sitting position (pefsitm)</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mean of the three measurements made in a standing position (pefstam)</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mean of all six PEF values (pefmean)</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1a) </span></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>We shall consider the difference betweenn PEF measured in a sitting position and in a standing position, i.e. we look at <span class="in">`diff_pef = pefstam - pefsitm`</span>.  First compute this variable. </span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-1a-1</span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>lung_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/PEFH98-english.csv'</span>)</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lung_data, <span class="dv">3</span>)</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diff_pef</span></span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>diff_pef <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefstam <span class="sc">-</span> lung_data<span class="sc">$</span>pefsitm</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1b) </span></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>Make a histogram and Q-Q plot for the differences. </span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-1b-1</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(diff_pef)</span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot </span></span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(diff_pef)</span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(diff_pef)</span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1c) </span></span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a>Do a non-parametric test to decide whether <span class="in">`pefsitm`</span> and <span class="in">`pefstam`</span> are significantly different.</span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-1c-1</span></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a><span class="co"># one sample (signed rank test)</span></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(diff_pef)</span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-1c-2</span></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively</span></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a>pefstam <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefstam</span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a>pefsitm <span class="ot">&lt;-</span> lung_data<span class="sc">$</span>pefsitm</span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(pefstam, pefsitm, <span class="at">paired =</span> T) <span class="co"># paired </span></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-1c-3</span></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a><span class="co"># the data is not severly skewed, can also use t-test </span></span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(pefstam, pefsitm, <span class="at">paired =</span> T)</span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 2 (length of hospital stay)</span></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a>The data was collected at the Geriatric Department at Ullevål Sykehus. Below is a description of the data set <span class="in">`liggetid`</span>. The file includes the following variables:</span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Year of birth (faar)</span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Month of birth (fmaan)</span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Day of birth (fdag)</span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Year of hospital admission (innaar)</span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Month of admission (innmaan)</span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Day of admission (inndag)</span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Year of discharge from hospital (utaar)</span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Month of discharge (utmaan)</span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Day of discharge (utdag)</span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gender, where 1 = male and 0 = female (kjoenn)</span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Admission from, where 1 = home, 2 = Div. of Medicine, 3 =</span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a>Div. of Surgery, 4 = Other division, 5 = Other hospital, 6 =</span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a>Nursing home (kom_fra)</span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stroke, where 1 = yes, 0 = no (slag)</span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Age (alder)</span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Hospital stay, in days (liggetid)</span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Logarithm of hospital stay (lnliggti)</span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comes from Div. of Medicine (kom_fra2)</span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comes from Div. of Surgery (kom_fra3)</span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comes from Other division (kom_fra4)</span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comes from Other hospital (kom_fra5)</span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comes from Nursing home (kom_fra6)</span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Censoring variable (censor)</span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>The variable <span class="in">`liggetid`</span> time is calculated from the <span class="in">`innaar`</span>, <span class="in">`innmaan`</span>, <span class="in">`inndag`</span>, <span class="in">`utaar`</span>, <span class="in">`utmaan`</span> and <span class="in">`utdag`</span> variables. </span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2a)</span></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a>We want to compare the **length of hospital stay** for patients with and without **stroke**. First get a better understanding of the data. Start with computing some summary (descriptive) statistics for these two variables: </span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**mean, median, min, max, 75-th percentile** for length of hospital stay (<span class="in">`liggetid`</span>);</span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**count** of how many patient have stroke, and do not have stroke (<span class="in">`slag == 1`</span> or <span class="in">`0`</span>)</span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a>Visualize the variable <span class="in">`liggetid`</span> using histogram and Q-Q plot, is the requirement for t-test met?</span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2a-1</span></span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a>liggetid <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/liggetid.csv'</span>)</span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(liggetid, <span class="dv">3</span>)</span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2a-2</span></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a><span class="co"># liggetid (length of stay: los)</span></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a>los <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>liggetid</span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>stroke <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>slag</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(los)</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stroke)</span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stroke) <span class="co"># this shows 85 missing</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(stroke)) <span class="co"># 85</span></span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2a-3</span></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize length of hospital stay (los)</span></span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(los, <span class="at">breaks =</span> <span class="dv">25</span>)</span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a><span class="co"># check normality</span></span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(los, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay'</span>)</span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(los, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2b) </span></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a>Since we want to compare the length of hospital stay for two groups, we need to separate the length of stay data into two groups, based on whether patients have stroke or not. Create two variables, <span class="in">`ligt_s1`</span> and <span class="in">`ligt_s0`</span>. </span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>Do an appropriate non-parametric test. What is the difference between this test and the one you did in Exercise 1?</span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a><span class="fu">## Separate one variable via index and `which()`</span></span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a>Previously, we showed how to separate one variable based on another,</span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 2c) in <span class="co">[</span><span class="ot">EDA I</span><span class="co">](https://ocbe-uio.github.io/teaching_mf9130e/lab/lab_eda_part1.html)</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Exercise 2a) in <span class="co">[</span><span class="ot">Categorical data analysis</span><span class="co">](https://ocbe-uio.github.io/teaching_mf9130e/lab/lab_categorical.html)</span></span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a>You can try to use this method here as well; but you might notice that there are some NA in the results. This is because when you do <span class="in">`stroke == 0`</span> on NA, instead of giving you <span class="in">`T`</span> or <span class="in">`F`</span>, it gives <span class="in">`NA`</span>; so the result of filtering <span class="in">`liggetid`</span> keeps both <span class="in">`T`</span> and <span class="in">`NA`</span>. </span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a>These NAs can be removed post-hoc; but a clearer solution is to set 2 conditions inside the square bracket, and combine with <span class="in">`&amp;`</span>. </span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`!is.na(stroke)`</span> means stroke variable not NA</span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`stroke == 1`</span> means stroke variable equals to 1</span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`which()`</span> identifies the indices for stroke where the conditions were met, e.g. the 4th, 22th elements.</span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2b-1</span></span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a><span class="co"># separate los </span></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a>ligt_s1 <span class="ot">&lt;-</span> los[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a>ligt_s0 <span class="ot">&lt;-</span> los[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">0</span>)]</span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a><span class="co"># mean, median </span></span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(ligt_s1), <span class="fu">median</span>(ligt_s1))</span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(ligt_s0), <span class="fu">median</span>(ligt_s0))</span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2b-2</span></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a><span class="co"># s1</span></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ligt_s1, <span class="at">main =</span> <span class="st">'Length of hospital stay, stroke yes'</span>, </span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'mean: 145; median: 58'</span>, </span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1300</span>))</span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(ligt_s1), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(ligt_s1), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">'dashed'</span>)</span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(ligt_s1, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay, stroke yes'</span>)</span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(ligt_s1, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="co"># s0</span></span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ligt_s0, <span class="at">main =</span> <span class="st">'Length of hospital stay, stroke no'</span>, </span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'mean: 116; median: 40'</span>, </span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1300</span>))</span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(ligt_s0), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(ligt_s0), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="st">'dashed'</span>)</span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(ligt_s0, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for length of stay, stroke no'</span>)</span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(ligt_s0, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2b-3</span></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a><span class="co"># non parametric test</span></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a><span class="co"># not matched; independent samples</span></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a><span class="co"># wilcoxon rank sum </span></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(ligt_s1, ligt_s0)</span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution}</span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compare with t-test</span></span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a>If you do a t-test (inappropriately) instead of Mann-Whitney U test, you'll have different results!</span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2b-4</span></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test on skewed data</span></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ligt_s1, ligt_s0)</span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2c)</span></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a>Do the same analysis with a t-test on the logarithm-transformed data. The transformed variable already exists in the data set as <span class="in">`lnliggti`</span>.</span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-2c-1</span></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a><span class="co"># use log transformed </span></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a>loglos <span class="ot">&lt;-</span> liggetid<span class="sc">$</span>lnliggti</span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(loglos, <span class="at">main =</span> <span class="st">'Log transformed length of stay'</span>)</span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(loglos, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for log(length of stay)'</span>)</span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(loglos, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a><span class="co"># separate data</span></span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a>logligt_s1 <span class="ot">&lt;-</span> loglos[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">1</span>)]</span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a>logligt_s0 <span class="ot">&lt;-</span> loglos[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(stroke) <span class="sc">&amp;</span> stroke <span class="sc">==</span> <span class="dv">0</span>)]</span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(logligt_s1, logligt_s0, <span class="at">paired =</span> F)</span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 3 (antibody)</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>(Baker et al., 1980) We have data on concentration of antibody of Type III Group B Streptococcus (GBS) in 20 volunteers before and after immunization. The dataset is <span class="in">`antibody`</span>. </span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3a) </span></span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a>The comparison of the antibody levels was summarized in the report of this study as '$t = 1.8; P &gt; 0.05$'. Comment on the result. </span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-1</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a>antibody <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/antibody.csv'</span>)</span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(antibody)</span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a>before <span class="ot">&lt;-</span> antibody<span class="sc">$</span>before</span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> antibody<span class="sc">$</span>after</span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a>Compute some summary statistics for the two variables, and then reproduce the result by the t-test.</span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-2</span></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a><span class="co"># some summary stat of the data</span></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(before)</span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(after)</span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a><span class="co"># reproduce the result from t-test</span></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(antibody<span class="sc">$</span>before, antibody<span class="sc">$</span>after, <span class="at">paired =</span> T)</span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a><span class="fu">### (Optional)</span></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a>We can visually get an understanding of whether this result makes sense.</span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-3</span></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a><span class="co"># long format data (requires tidyr package)</span></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a>antibody_longdata <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(antibody, </span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">cols =</span> tidyr<span class="sc">::</span><span class="fu">everything</span>(), </span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">names_to =</span> <span class="st">'group'</span>, </span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">values_to =</span> <span class="st">'measurements'</span>)</span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(antibody_longdata)</span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-4</span></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(measurements <span class="sc">~</span> group, </span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> antibody_longdata, </span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> T, </span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Before and after measurements'</span>)</span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a><span class="co"># limit the y axis (horizontal x axis)</span></span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(measurements <span class="sc">~</span> group, </span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> antibody_longdata, </span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> T, </span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Limit the measurement range'</span>)</span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-5</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram </span></span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(before, <span class="at">main =</span> <span class="st">'Measurements: before'</span>)</span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(before, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for measurements: before'</span>)</span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(before, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(after, <span class="at">main =</span> <span class="st">'Measurements: after'</span>)</span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(after, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">'Q-Q plot for measurements: after'</span>)</span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(after, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3a-6</span></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for the difference s</span></span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(after <span class="sc">-</span> before, <span class="at">main =</span> <span class="st">'Difference (after - before)'</span>)</span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3b)</span></span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-508"><a href="#cb68-508" aria-hidden="true" tabindex="-1"></a>Analyse the data with an appropriate test. Justify your choice. </span>
<span id="cb68-509"><a href="#cb68-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3b-1</span></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a><span class="co"># matched data (paired)</span></span>
<span id="cb68-518"><a href="#cb68-518" aria-hidden="true" tabindex="-1"></a><span class="co"># one-sample test (signed rank)</span></span>
<span id="cb68-519"><a href="#cb68-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(before, after, <span class="at">paired =</span> T)</span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a><span class="co"># the error means there are ties (no change)</span></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution}</span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired vs independent data</span></span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a>You can try to do a test treating the data as independent. The conclusion could be different! Be careful with what you are testing.</span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-3b-2</span></span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a><span class="co"># what happens if you use independent two-samples test?</span></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(before, after, <span class="at">paired =</span> F) <span class="co"># p = 0.14</span></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 4 (nausea) </span></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a>(Williams et al., 1989) Patients receiving chemotherapy as outpatients were randomized to receive either an active antiemetic treatment or placebo. The following table shows measurements (in mm) on a 100mm linear analogue self-assessment scale for nausea. The dataset is <span class="in">`nausea`</span>. </span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>group: <span class="in">`1`</span> is active (treatment), and <span class="in">`2`</span> is placebo.</span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4a)</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a>Choose an appropriate test for comparing the treatment and placebo groups. Justify your choice. </span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-4a-1</span></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a>nausea <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/nausea.csv'</span>)</span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nausea)</span>
<span id="cb68-561"><a href="#cb68-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-562"><a href="#cb68-562" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> nausea<span class="sc">$</span>value[nausea<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb68-563"><a href="#cb68-563" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> nausea<span class="sc">$</span>value[nausea<span class="sc">$</span>group <span class="sc">==</span> <span class="dv">2</span>]</span>
<span id="cb68-564"><a href="#cb68-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-565"><a href="#cb68-565" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(treatment)</span>
<span id="cb68-566"><a href="#cb68-566" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(placebo)</span>
<span id="cb68-567"><a href="#cb68-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-568"><a href="#cb68-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-569"><a href="#cb68-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-572"><a href="#cb68-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-573"><a href="#cb68-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-4a-2</span></span>
<span id="cb68-574"><a href="#cb68-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-575"><a href="#cb68-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-576"><a href="#cb68-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-577"><a href="#cb68-577" aria-hidden="true" tabindex="-1"></a><span class="co"># these samples are not matched: two sample independent test</span></span>
<span id="cb68-578"><a href="#cb68-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-579"><a href="#cb68-579" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot</span></span>
<span id="cb68-580"><a href="#cb68-580" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(value <span class="sc">~</span> group, <span class="at">data =</span> nausea, </span>
<span id="cb68-581"><a href="#cb68-581" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Nausea: treatment vs placebo'</span>)</span>
<span id="cb68-582"><a href="#cb68-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-583"><a href="#cb68-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-584"><a href="#cb68-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-585"><a href="#cb68-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-588"><a href="#cb68-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-589"><a href="#cb68-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: nonpara-4a-3</span></span>
<span id="cb68-590"><a href="#cb68-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb68-591"><a href="#cb68-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb68-592"><a href="#cb68-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-593"><a href="#cb68-593" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(treatment, placebo, <span class="at">paired =</span> F)</span>
<span id="cb68-594"><a href="#cb68-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>